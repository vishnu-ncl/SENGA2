!
! auto-generated by ops_fortran.py
!
SUBROUTINE rhscal

    use OPS_Fortran_Declarations
  use OPS_Fortran_RT_Support
  use BOUNDARY_KERNEL_CPANDGAS_XDIR_MODULE
  use BOUNDARY_KERNEL_CPANDGAS_YDIR_MODULE
  use BOUNDARY_KERNEL_CPANDGAS_ZDIR_MODULE
  use MATH_KERNEL_EQL_MODULE
  use MATH_KERNEL_EQS_MODULE
  use BOUNDARY_KERNEL_INTERNALENERGY_XDIR_MODULE
  use BOUNDARY_KERNEL_INTERNALENERGY_YDIR_MODULE
  use BOUNDARY_KERNEL_INTERNALENERGY_ZDIR_MODULE
  use MATH_KERNEL_EQV_MODULE
  use MATH_KERNEL_EQM_MODULE
  use MATH_KERNEL_EQAD_MODULE
  use BOUNDARY_KERNEL_TEMPERATURE_XDIR_MODULE
  use BOUNDARY_KERNEL_TEMPERATURE_YDIR_MODULE
  use BOUNDARY_KERNEL_TEMPERATURE_ZDIR_MODULE
  use MATH_KERNEL_EQAP_MODULE
  use MATH_MD_KERNEL_EQV_MODULE
  use MATH_KERNEL_EQAA_MODULE
  use HEAT_FLUX_KERNEL_THERMAL_FXLCNW_MODULE
  use HEAT_FLUX_KERNEL_THERMAL_FXRCNW_MODULE
  use HEAT_FLUX_KERNEL_THERMAL_FYLCNW_MODULE
  use HEAT_FLUX_KERNEL_THERMAL_FYRCNW_MODULE
  use HEAT_FLUX_KERNEL_THERMAL_FZLCNW_MODULE
  use HEAT_FLUX_KERNEL_THERMAL_FZRCNW_MODULE
  use MATH_KERNEL_EQY_MODULE
  use MATH_MD_KERNEL_EQB_MODULE
  use BOUNDARY_KERNEL_REACTION_XDIR_MODULE
  use BOUNDARY_KERNEL_REACTION_YDIR_MODULE
  use BOUNDARY_KERNEL_REACTION_ZDIR_MODULE
  use SET_ZERO_KERNEL_MODULE
  use MATH_KERNEL_EQA_MODULE
  use MATH_MD_KERNEL_EQE_MODULE
  use MATH_MD_KERNEL_EQI_MODULE
  use MATH_MD_KERNEL_EQD_MODULE
  use MATH_MD_KERNEL_EQH_MODULE
  use MATH_MD_KERNEL_EQA_MODULE
  use BOUNDARY_KERNEL_MASS_XDIR_MODULE
  use BOUNDARY_KERNEL_MASS_YDIR_MODULE
  use BOUNDARY_KERNEL_MASS_ZDIR_MODULE
  use MATH_MD_KERNEL_EQJ_MODULE
  use MATH_KERNEL_EQD_MODULE
  use MATH_MD_KERNEL_EQW_MODULE
  use MATH_MD_KERNEL_EQX_MODULE
  use MATH_KERNEL_EQN_MODULE
  use MATH_MD_KERNEL_EQZ_MODULE
  use BOUNDARY_KERNEL_SPECIESH_XDIR_MODULE
  use BOUNDARY_KERNEL_SPECIESH_YDIR_MODULE
  use BOUNDARY_KERNEL_SPECIESH_ZDIR_MODULE
  use MATH_KERNEL_EQF_MODULE
  use MATH_MD_KERNEL_EQL_MODULE
  use MATH_KERNEL_EQAB_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY2_FXLDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY2_FXRDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY2_FYLDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY2_FYRDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY2_FZLDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY2_FZRDFW_MODULE
  use COPY_KERNEL_MODULE
  use MATH_MD_KERNEL_EQM_MODULE
  use MATH_KERNEL_EQZ_MODULE
  use MATH_MD_KERNEL_EQC_MODULE
  use MATH_MD_KERNEL_EQG_MODULE
  use MATH_MD_KERNEL_EQF_MODULE
  use MATH_KERNEL_EQH_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY_FXLDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY_FXRDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY_FYLDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY_FYRDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY_FZLDFW_MODULE
  use HEAT_FLUX_KERNEL_ENTHALPY_FZRDFW_MODULE
  use HEAT_FLUX_KERNEL_SORET_FXLCNW_MODULE
  use HEAT_FLUX_KERNEL_SORET_FXRCNW_MODULE
  use HEAT_FLUX_KERNEL_SORET_FYLCNW_MODULE
  use HEAT_FLUX_KERNEL_SORET_FYRCNW_MODULE
  use HEAT_FLUX_KERNEL_SORET_FZLCNW_MODULE
  use HEAT_FLUX_KERNEL_SORET_FZRCNW_MODULE
  use HEAT_FLUX_KERNEL_ISOTHERMAL_FXLADW_MODULE
  use HEAT_FLUX_KERNEL_ISOTHERMAL_FXRADW_MODULE
  use HEAT_FLUX_KERNEL_ISOTHERMAL_FYLADW_MODULE
  use HEAT_FLUX_KERNEL_ISOTHERMAL_FYRADW_MODULE
  use HEAT_FLUX_KERNEL_ISOTHERMAL_FZLADW_MODULE
  use HEAT_FLUX_KERNEL_ISOTHERMAL_FZRADW_MODULE
  use MATH_KERNEL_EQAH_MODULE
  use MATH_MD_KERNEL_EQY_MODULE
  use MATH_MD_KERNEL_EQK_MODULE
  use BOUNDARY_KERNEL_DENSITY_XDIR_MODULE
  use BOUNDARY_KERNEL_DENSITY_YDIR_MODULE
  use BOUNDARY_KERNEL_DENSITY_ZDIR_MODULE

    use OPS_CONSTANTS
    use, intrinsic :: ISO_C_BINDING

    use data_types
    use com_senga
    use com_ops_senga



















    integer :: ispec
    integer :: iindex,ipower,icoef1,icoef2
    logical :: flmtds
    integer :: rangexyz(6)






    call temper





    IF(fxlcnv)THEN
        rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
        call boundary_kernel_CPandGAS_xdir_host("COLLECT CP AND GAS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strgxl, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_strrxl, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE))

    END IF
    IF(fxrcnv)THEN
        rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
        call boundary_kernel_CPandGAS_xdir_host("COLLECT CP AND GAS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strgxr, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_strrxr, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE))

    END IF

    IF(fylcnv)THEN
        rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
        call boundary_kernel_CPandGAS_ydir_host("COLLECT CP AND GAS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strgyl, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_strryl, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE))

    END IF
    IF(fyrcnv)THEN
        rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
        call boundary_kernel_CPandGAS_ydir_host("COLLECT CP AND GAS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strgyr, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_strryr, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE))

    END IF

    IF(fzlcnv)THEN
        rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
        call boundary_kernel_CPandGAS_zdir_host("COLLECT CP AND GAS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strgzl, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_strrzl, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE))

    END IF
    IF(fzrcnv)THEN
        rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
        call boundary_kernel_CPandGAS_zdir_host("COLLECT CP AND GAS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strgzr, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_strrzr, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE))

    END IF




    call dfbydx(d_urhs,d_store1)
    call dfbydy(d_vrhs,d_store2)
    call dfbydz(d_wrhs,d_store3)

    rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)

    call math_kernel_eqL_host("A=B+C+D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_divm, 1, s3d_000, "real(8)", OPS_WRITE), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ))







    rangexyz(1) = 1-nhalox
    IF (nsbcxl == nsbco1 .or. nsbcxl == nsbci1 .or. nsbcxl == nsbci2 .or. &
        nsbcxl == nsbci3 .or. nsbcxl == nsbcw1 .or. nsbcxl == nsbcw2) rangexyz(1) = 1

    rangexyz(2) = nxglbl+nhalox
    IF (nsbcxr == nsbco1 .or. nsbcxr == nsbci1 .or. nsbcxr == nsbci2 .or. &
        nsbcxr == nsbci3 .or. nsbcxr == nsbcw1 .or. nsbcxr == nsbcw2) rangexyz(2) = nxglbl

    rangexyz(3) = 1-nhaloy
    IF (nsbcyl == nsbco1 .or. nsbcyl == nsbci1 .or. nsbcyl == nsbci2 .or. &
        nsbcyl == nsbci3 .or. nsbcyl == nsbcw1 .or. nsbcyl == nsbcw2) rangexyz(3) = 1

    rangexyz(4) = nyglbl+nhaloy
    IF (nsbcyr == nsbco1 .or. nsbcyr == nsbci1 .or. nsbcyr == nsbci2 .or. &
        nsbcyr == nsbci3 .or. nsbcyr == nsbcw1 .or. nsbcyr == nsbcw2) rangexyz(4) = nyglbl

    rangexyz(5) = 1-nhaloz
    IF (nsbczl == nsbco1 .or. nsbczl == nsbci1 .or. nsbczl == nsbci2 .or. &
        nsbczl == nsbci3 .or. nsbczl == nsbcw1 .or. nsbczl == nsbcw2) rangexyz(5) = 1

    rangexyz(6) = nzglbl+nhaloz
    IF (nsbczr == nsbco1 .or. nsbczr == nsbci1 .or. nsbczr == nsbci2 .or. &
        nsbczr == nsbci3 .or. nsbczr == nsbcw1 .or. nsbczr == nsbcw2) rangexyz(6) = nzglbl
    call math_kernel_eqS_host("A=A/B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_RW), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ))




    IF(fxlcnv)THEN
        rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
        call boundary_kernel_internalenergy_xdir_host("COLLECT INTERNAL ENERGY FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strexl, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE))

    END IF
    IF(fxrcnv)THEN
        rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
        call boundary_kernel_internalenergy_xdir_host("COLLECT INTERNAL ENERGY FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strexr, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE))

    END IF

    IF(fylcnv)THEN
        rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
        call boundary_kernel_internalenergy_ydir_host("COLLECT INTERNAL ENERGY FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_streyl, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE))

    END IF
    IF(fyrcnv)THEN
        rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
        call boundary_kernel_internalenergy_ydir_host("COLLECT INTERNAL ENERGY FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_streyr, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE))

    END IF

    IF(fzlcnv)THEN
        rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
        call boundary_kernel_internalenergy_zdir_host("COLLECT INTERNAL ENERGY FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strezl, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE))

    END IF
    IF(fzrcnv)THEN
        rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
        call boundary_kernel_internalenergy_zdir_host("COLLECT INTERNAL ENERGY FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strezr, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE))

    END IF





    rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
    call math_kernel_eqV_host("A=B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_WRITE), &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_divm, 1, s3d_000, "real(8)", OPS_READ))





    rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
    call math_kernel_eqV_host("A=B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(8)", OPS_READ))

    call dfbydx(d_store7,d_store1)


    rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
    call math_kernel_eqV_host("A=B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(8)", OPS_READ))

    call dfbydy(d_store7,d_store2)


    rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
    call math_kernel_eqV_host("A=B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(8)", OPS_READ))

    call dfbydz(d_store7,d_store3)

    rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
    call math_kernel_eqM_host("A=A+B+C+D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ))




    call dfbydx(d_erhs,d_store1)
    call dfbydy(d_erhs,d_store2)
    call dfbydz(d_erhs,d_store3)

    rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
    call math_kernel_eqAD_host("A = -half*(B+C*D+E*F+G*H)", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_WRITE), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(8)", OPS_READ))






    call dfbydx(d_trun,d_store1)
    call dfbydy(d_trun,d_store2)
    call dfbydz(d_trun,d_store3)




    IF(fxlcnv) THEN
        rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
        call boundary_kernel_temperature_xdir_host("COLLECT TEMPERATURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strtxl, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcltxl, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE))

    END IF
    IF(fxrcnv) THEN
        rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
        call boundary_kernel_temperature_xdir_host("COLLECT TEMPERATURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strtxr, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcltxr, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE))

    END IF

    IF(fylcnv)THEN
        rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
        call boundary_kernel_temperature_ydir_host("COLLECT TEMPERATURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strtyl, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcltyl, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE))

    END IF
    IF(fyrcnv)THEN
        rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
        call boundary_kernel_temperature_ydir_host("COLLECT TEMPERATURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strtyr, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcltyr, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE))

    END IF

    IF(fzlcnv)THEN
        rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
        call boundary_kernel_temperature_zdir_host("COLLECT TEMPERATURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strtzl, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcltzl, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE))

    END IF
    IF(fzrcnv)THEN
        rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
        call boundary_kernel_temperature_zdir_host("COLLECT TEMPERATURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_strtzr, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcltzr, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE))

    END IF







    rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
    call math_kernel_eqAP_host("THERMAL CONDUCTIVITY", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_RW), &
                      & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ))



    IF(flmavt) THEN
        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_MD_kernel_eqV_host("THERMAL CONDUCTIVITY", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_RW), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_wmomix, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(condco, nccfmx*nspcmx, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ovwmol, nspcmx, "real(8)", OPS_READ), &
                          & ops_arg_gbl(tdifgb, 1, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ncocon, 1, "integer", OPS_READ), &
                          & ops_arg_gbl(ncocm1, 1, "integer", OPS_READ))

    END IF

    call dfbydx(d_store7,d_store4)
    call dfbydy(d_store7,d_store5)
    call dfbydz(d_store7,d_store6)


    IF(fxlcon) call zeroxl(d_store4)
    IF(fxrcon) call zeroxr(d_store4)

    IF(fylcon) call zeroyl(d_store5)
    IF(fyrcon) call zeroyr(d_store5)


    IF(fzlcon) call zerozl(d_store6)
    IF(fzrcon) call zerozr(d_store6)

    rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
    call math_kernel_eqAA_host("A = A+(B*C+D*E+F*G)", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ))




    IF(fxlcnw) THEN
        rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
        call heat_flux_kernel_thermal_fxlcnw_host("HEAT FLUX: Thermal fxlcnw", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store1, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                          & ops_arg_gbl(acbcxl, ncbcsz, "real(8)", OPS_READ))

    END IF
    IF(fxrcnw) THEN
        rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
        call heat_flux_kernel_thermal_fxrcnw_host("HEAT FLUX: Thermal fxrcnw", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store1, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                          & ops_arg_gbl(acbcxr, ncbcsz, "real(8)", OPS_READ))

    END IF
    IF(fylcnw) THEN
        rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
        call heat_flux_kernel_thermal_fylcnw_host("HEAT FLUX: Thermal fylcnw", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store2, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                          & ops_arg_gbl(acbcyl, ncbcsz, "real(8)", OPS_READ))

    END IF
    IF(fyrcnw) THEN
        rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
        call heat_flux_kernel_thermal_fyrcnw_host("HEAT FLUX: Thermal fyrcnw", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store2, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                          & ops_arg_gbl(acbcyr, ncbcsz, "real(8)", OPS_READ))

    END IF
    IF(fzlcnw) THEN
        rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
        call heat_flux_kernel_thermal_fzlcnw_host("HEAT FLUX: Thermal fzlcnw", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store3, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                          & ops_arg_gbl(acbczl, ncbcsz, "real(8)", OPS_READ))

    END IF
    IF(fzrcnw)THEN
        rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
        call heat_flux_kernel_thermal_fzrcnw_host("HEAT FLUX: Thermal fzrcnw", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store3, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                          & ops_arg_gbl(acbczr, ncbcsz, "real(8)", OPS_READ))
    END IF




    call d2fdx2(d_trun,d_store1)
    call d2fdy2(d_trun,d_store2)
    call d2fdz2(d_trun,d_store3)


    IF(fxlcon) call zeroxl(d_store1)
    IF(fxrcon) call zeroxr(d_store1)

    IF(fylcon) call zeroyl(d_store2)
    IF(fyrcon) call zeroyr(d_store2)


    IF(fzlcon) call zerozl(d_store3)
    IF(fzrcon) call zerozr(d_store3)

    rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
    call math_kernel_eqY_host("A = A+(B+C+D)*E", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ))






    IF(flradn) call radcal






    call chrate

    DO ispec = 1,nspec
        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_MD_kernel_eqB_host("A_multidim = B_multidim", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_rrte, 9, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

    END DO




    IF(fxlcnv)THEN
        DO ispec = 1,nspec
            rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
            call boundary_kernel_reaction_xdir_host("COLLECT REACTION RATE FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_ratexl, 9, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END DO
    END IF
    IF(fxrcnv)THEN
        DO ispec = 1,nspec
            rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
            call boundary_kernel_reaction_xdir_host("COLLECT REACTION RATE FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_ratexr, 9, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END DO
    END IF

    IF(fylcnv)THEN
        DO ispec = 1,nspec
            rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
            call boundary_kernel_reaction_ydir_host("COLLECT REACTION RATE FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_rateyl, 9, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END DO
    END IF
    IF(fyrcnv)THEN
        DO ispec = 1,nspec
            rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
            call boundary_kernel_reaction_ydir_host("COLLECT REACTION RATE FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_rateyr, 9, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END DO
    END IF

    IF(fzlcnv)THEN
        DO ispec = 1,nspec
            rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
            call boundary_kernel_reaction_zdir_host("COLLECT REACTION RATE FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_ratezl, 9, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END DO
    END IF
    IF(fzrcnv)THEN
        DO ispec = 1,nspec
            rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
            call boundary_kernel_reaction_zdir_host("COLLECT REACTION RATE FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_ratezr, 9, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END DO
    END IF




    rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
    call set_zero_kernel_host("set_zero", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_ucor, 1, s3d_000, "real(8)", OPS_WRITE))

    call set_zero_kernel_host("set_zero", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vcor, 1, s3d_000, "real(8)", OPS_WRITE))

    call set_zero_kernel_host("set_zero", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wcor, 1, s3d_000, "real(8)", OPS_WRITE))

    call set_zero_kernel_host("set_zero", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_WRITE))



    rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
    call set_zero_kernel_host("set_zero", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(8)", OPS_WRITE))






    IF(flmixw) THEN

        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_kernel_eqA_host("A=log(B)", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_wmomix, 1, s3d_000, "real(8)", OPS_READ))

        call dfbydx(d_store7,d_wd1x)
        call dfbydy(d_store7,d_wd1y)
        call dfbydz(d_store7,d_wd1z)
        call d2fdx2(d_store7,d_wd2x)
        call d2fdy2(d_store7,d_wd2y)
        call d2fdz2(d_store7,d_wd2z)

    END IF

    IF(flmixp) THEN

        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_kernel_eqA_host("A=log(B)", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_prun, 1, s3d_000, "real(8)", OPS_READ))

        call dfbydx(d_store7,d_pd1x)
        call dfbydy(d_store7,d_pd1y)
        call dfbydz(d_store7,d_pd1z)
        call d2fdx2(d_store7,d_pd2x)
        call d2fdy2(d_store7,d_pd2y)
        call d2fdz2(d_store7,d_pd2z)

    END IF

    IF(flmixt)THEN

        call dfbydx(d_transp,d_td1x)
        call dfbydy(d_transp,d_td1y)
        call dfbydz(d_transp,d_td1z)
        call d2fdx2(d_transp,d_td2x)
        call d2fdy2(d_transp,d_td2y)
        call d2fdz2(d_transp,d_td2z)

    END IF




    DO ispec = 1,nspec



        rangexyz(1) = 1-nhalox
        IF (nsbcxl == nsbco1 .or. nsbcxl == nsbci1 .or. nsbcxl == nsbci2 .or. &
            nsbcxl == nsbci3 .or. nsbcxl == nsbcw1 .or. nsbcxl == nsbcw2) rangexyz(1) = 1

        rangexyz(2) = nxglbl+nhalox
        IF (nsbcxr == nsbco1 .or. nsbcxr == nsbci1 .or. nsbcxr == nsbci2 .or. &
            nsbcxr == nsbci3 .or. nsbcxr == nsbcw1 .or. nsbcxr == nsbcw2) rangexyz(2) = nxglbl

        rangexyz(3) = 1-nhaloy
        IF (nsbcyl == nsbco1 .or. nsbcyl == nsbci1 .or. nsbcyl == nsbci2 .or. &
            nsbcyl == nsbci3 .or. nsbcyl == nsbcw1 .or. nsbcyl == nsbcw2) rangexyz(3) = 1

        rangexyz(4) = nyglbl+nhaloy
        IF (nsbcyr == nsbco1 .or. nsbcyr == nsbci1 .or. nsbcyr == nsbci2 .or. &
            nsbcyr == nsbci3 .or. nsbcyr == nsbcw1 .or. nsbcyr == nsbcw2) rangexyz(4) = nyglbl

        rangexyz(5) = 1-nhaloz
        IF (nsbczl == nsbco1 .or. nsbczl == nsbci1 .or. nsbczl == nsbci2 .or. &
            nsbczl == nsbci3 .or. nsbczl == nsbcw1 .or. nsbczl == nsbcw2) rangexyz(5) = 1

        rangexyz(6) = nzglbl+nhaloz
        IF (nsbczr == nsbco1 .or. nsbczr == nsbci1 .or. nsbczr == nsbci2 .or. &
            nsbczr == nsbci3 .or. nsbczr == nsbcw1 .or. nsbczr == nsbcw2) rangexyz(6) = nzglbl

        call math_MD_kernel_eqE_host("A_multidim = A_multidim/B", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_RW), &
                          & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))





        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_MD_kernel_eqI_host("A_multidim = A_multidim - half*B_multidim*C", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_divm, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))






        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_MD_kernel_eqD_host("A = B_multidim*C", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_urhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        call dfbydx(d_store7,d_store1)


        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_MD_kernel_eqD_host("A = B_multidim*C", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_vrhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        call dfbydy(d_store7,d_store2)


        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_MD_kernel_eqD_host("A = B_multidim*C", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_wrhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        call dfbydz(d_store7,d_store3)


        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_MD_kernel_eqH_host("A_multidim = A_multidim - half*(B+C+D)", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))






        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_MD_kernel_eqA_host("A = B_multidim", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        call dfbydx(d_store7,d_store1)
        call dfbydy(d_store7,d_store2)
        call dfbydz(d_store7,d_store3)







        IF(fxlcnv) THEN
            rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
            call boundary_kernel_mass_xdir_host("COLLECT SPECIES MASS FRACTION AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_stryxl, 9, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bclyxl, 9, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fxrcnv) THEN
            rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
            call boundary_kernel_mass_xdir_host("COLLECT SPECIES MASS FRACTION AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_stryxr, 9, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bclyxr, 9, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF

        IF(fylcnv) THEN
            rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
            call boundary_kernel_mass_ydir_host("COLLECT SPECIES MASS FRACTION AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_stryyl, 9, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bclyyl, 9, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fyrcnv) THEN
            rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
            call boundary_kernel_mass_ydir_host("COLLECT SPECIES MASS FRACTION AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_stryyr, 9, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bclyyr, 9, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF

        IF(fzlcnv) THEN
            rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
            call boundary_kernel_mass_zdir_host("COLLECT SPECIES MASS FRACTION AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_stryzl, 9, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bclyzl, 9, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fzrcnv) THEN
            rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
            call boundary_kernel_mass_zdir_host("COLLECT SPECIES MASS FRACTION AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_stryzr, 9, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bclyzr, 9, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF






        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_MD_kernel_eqJ_host("A_multidim = A_multidim - half*(B*C+D*E+F*G)", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_urhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_vrhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_wrhs, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))











        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_kernel_eqD_host("A=B*val", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(olewis, nspcmx, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))






        IF(flmavt) THEN


            rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
            call math_MD_kernel_eqW_host("MASS DIFFUSIVITY FOR EACH SPECIES", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_difmix, 1, s3d_000, "real(8)", OPS_RW), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_prun, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wmomix, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(diffco, ndcfmx*nspcmx*nspcmx, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ovwmol, nspcmx, "real(8)", OPS_READ), &
                              & ops_arg_gbl(pdifgb, 1, "real(8)", OPS_READ), &
                              & ops_arg_gbl(dfctol, 1, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ), &
                              & ops_arg_gbl(ncodif, 1, "integer", OPS_READ), &
                              & ops_arg_gbl(ncodm1, 1, "integer", OPS_READ), &
                              & ops_arg_gbl(nspec, 1, "integer", OPS_READ))

        END IF




        IF(flmtdr(ispec))THEN



            rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
            call set_zero_kernel_host("set_zero", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_WRITE))

            DO jspec = 1, nspec

                flmtds = flmtdr(jspec).AND.(ispec /= jspec)
                IF(flmtds)THEN

                    rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
                    call math_MD_kernel_eqX_host("THERMAL DIFFUSION RATIO FOR EACH SPECIES", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_wmomix, 1, s3d_000, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(tdrcco, ndcfmx*nspcmx*nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ovwmol, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(tdifgb, 1, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ncotdr, 1, "integer", OPS_READ), &
                                      & ops_arg_gbl(jspec, 1, "integer", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ), &
                                      & ops_arg_gbl(ncotm1, 1, "integer", OPS_READ))

                END IF

            END DO

        END IF



        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_ucor, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ))

        call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_vcor, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ))

        call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_wcor, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ))







        iindex = 1 + (ispec-1)/nspimx
        ipower = ispec - (iindex-1)*nspimx - 1
        icoef2 = ntbase**ipower
        icoef1 = icoef2*ntbase



        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_MD_kernel_eqZ_host("SPECIES ENTHALPY", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_RW), &
                          & ops_arg_dat(d_wtmp, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_itndex, 2, s3d_000, "integer", OPS_READ), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(amasch, ncofmx*ntinmx*nspcmx, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ncpoly, ntinmx*nspcmx, "integer", OPS_READ), &
                          & ops_arg_gbl(ncpom1, ntinmx*nspcmx, "integer", OPS_READ), &
                          & ops_arg_gbl(ncenth, ntinmx*nspcmx, "integer", OPS_READ), &
                          & ops_arg_gbl(icoef1, 1, "integer", OPS_READ), &
                          & ops_arg_gbl(icoef2, 1, "integer", OPS_READ), &
                          & ops_arg_gbl(iindex, 1, "integer", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))








        IF(fxlcnv) THEN
            rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
            call boundary_kernel_speciesH_xdir_host("COLLECT SPECIES H FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strhxl, 9, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fxrcnv) THEN
            rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
            call boundary_kernel_speciesH_xdir_host("COLLECT SPECIES H FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strhxr, 9, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF


        IF(fylcnv) THEN
            rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
            call boundary_kernel_speciesH_ydir_host("COLLECT SPECIES H FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strhyl, 9, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fyrcnv) THEN
            rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
            call boundary_kernel_speciesH_ydir_host("COLLECT SPECIES H FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strhyr, 9, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF


        IF(fzlcnv) THEN
            rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
            call boundary_kernel_speciesH_zdir_host("COLLECT SPECIES H FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strhzl, 9, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fzrcnv) THEN
            rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
            call boundary_kernel_speciesH_zdir_host("COLLECT SPECIES H FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strhzr, 9, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF







        IF(flmduf(ispec)) THEN
            rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
            call math_kernel_eqF_host("A = A+var*B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF






        call dfbydx(d_store7,d_store4)
        call dfbydy(d_store7,d_store5)
        call dfbydz(d_store7,d_store6)


        IF(fxldif) call zeroxl(d_store4)
        IF(fxrdif) call zeroxr(d_store4)

        IF(fyldif) call zeroyl(d_store5)
        IF(fyrdif) call zeroyr(d_store5)

        IF(fzldif) call zerozl(d_store6)
        IF(fzrdif) call zerozr(d_store6)

        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_MD_kernel_eqL_host("multiple math equations", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store5, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store6, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


        IF(fxladb) call zeroxl(d_store4)
        IF(fxradb) call zeroxr(d_store4)

        IF(fyladb) call zeroyl(d_store5)
        IF(fyradb) call zeroyr(d_store5)

        IF(fzladb) call zerozl(d_store6)
        IF(fzradb) call zerozr(d_store6)

        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_kernel_eqAB_host("A = A+(B*C+D*E+F*G)*H", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store5, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store6, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ))








        call dfbydx(d_utmp,d_store4)
        call dfbydy(d_utmp,d_store5)
        call dfbydz(d_utmp,d_store6)


        IF(fxldif) call zeroxl(d_store4)
        IF(fxrdif) call zeroxr(d_store4)

        IF(fyldif) call zeroyl(d_store5)
        IF(fyrdif) call zeroyr(d_store5)

        IF(fzldif) call zerozl(d_store6)
        IF(fzrdif) call zerozr(d_store6)


        IF(fxladb) call zeroxl(d_store4)
        IF(fxradb) call zeroxr(d_store4)

        IF(fyladb) call zeroyl(d_store5)
        IF(fyradb) call zeroyr(d_store5)

        IF(fzladb) call zerozl(d_store6)
        IF(fzradb) call zerozr(d_store6)

        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_kernel_eqAB_host("A = A+(B*C+D*E+F*G)*H", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store5, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store6, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ))








        IF(fxldfw) THEN
            rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fxldfw_host("HEAT FLUX: Enthalpy fxldfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store1, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcxl, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fxrdfw) THEN
            rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fxrdfw_host("HEAT FLUX: Enthalpy fxrdfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store1, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcxr, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fyldfw) THEN
            rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fyldfw_host("HEAT FLUX: Enthalpy fyldfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcyl, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fyrdfw) THEN
            rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fyrdfw_host("HEAT FLUX: Enthalpy fyrdfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcyr, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fzldfw) THEN
            rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
            call heat_flux_kernel_enthalpy2_fzldfw_host("HEAT FLUX: Enthalpy fzldfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbczl, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF
        IF(fzrdfw) THEN
            rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
            call heat_flux_kernel_enthalpy2_fzrdfw_host("HEAT FLUX: Enthalpy fzrdfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbczr, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        END IF






        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call copy_kernel_host("copy", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ))

        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_MD_kernel_eqA_host("A = B_multidim", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        call d2fdx2(d_store7,d_store1)
        call d2fdy2(d_store7,d_store2)
        call d2fdz2(d_store7,d_store3)


        IF(fxldif) call zeroxl(d_store1)
        IF(fxrdif) call zeroxr(d_store1)

        IF(fyldif) call zeroyl(d_store2)
        IF(fyrdif) call zeroyr(d_store2)

        IF(fzldif) call zerozl(d_store3)
        IF(fzrdif) call zerozr(d_store3)

        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_MD_kernel_eqM_host("multiple math equations", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


        IF(fxladb) call zeroxl(d_store1)
        IF(fxradb) call zeroxr(d_store1)

        IF(fyladb) call zeroyl(d_store2)
        IF(fyradb) call zeroyr(d_store2)

        IF(fzladb) call zerozl(d_store3)
        IF(fzradb) call zerozr(d_store3)


        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_kernel_eqZ_host("A=A+(B+C+D)*E*F", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ))






        IF(flmixw) THEN

            rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
            call math_MD_kernel_eqC_host("A = B*C_multidim", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_difmix, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_ucor, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1x, 1, s3d_000, "real(8)", OPS_READ))

            call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_vcor, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1y, 1, s3d_000, "real(8)", OPS_READ))

            call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_wcor, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1z, 1, s3d_000, "real(8)", OPS_READ))





            call dfbydx(d_store7,d_store1)
            call dfbydy(d_store7,d_store2)
            call dfbydz(d_store7,d_store3)


            IF(fxldif) call zeroxl(d_store1)
            IF(fxrdif) call zeroxr(d_store1)

            IF(fyldif) call zeroyl(d_store2)
            IF(fyrdif) call zeroyr(d_store2)

            IF(fzldif) call zerozl(d_store3)
            IF(fzrdif) call zerozr(d_store3)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_MD_kernel_eqL_host("multiple math equations", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


            IF(fxladb) call zeroxl(d_store1)
            IF(fxradb) call zeroxr(d_store1)

            IF(fyladb) call zeroyl(d_store2)
            IF(fyradb) call zeroyr(d_store2)

            IF(fzladb) call zerozl(d_store3)
            IF(fzradb) call zerozr(d_store3)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqAB_host("A = A+(B*C+D*E+F*G)*H", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ))




            IF(fxldif) call zeroxl(d_store4)
            IF(fxrdif) call zeroxr(d_store4)

            IF(fyldif) call zeroyl(d_store5)
            IF(fyrdif) call zeroyr(d_store5)

            IF(fzldif) call zerozl(d_store6)
            IF(fzrdif) call zerozr(d_store6)


            IF(fxladb) call zeroxl(d_store4)
            IF(fxradb) call zeroxr(d_store4)

            IF(fyladb) call zeroyl(d_store5)
            IF(fyradb) call zeroyr(d_store5)

            IF(fzladb) call zerozl(d_store6)
            IF(fzradb) call zerozr(d_store6)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqAB_host("A = A+(B*C+D*E+F*G)*H", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store5, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store6, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ))





            IF(fxldfw) THEN
                rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fxldfw_host("HEAT FLUX: Enthalpy fxldfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1x, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcxl, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fxrdfw) THEN
                rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fxrdfw_host("HEAT FLUX: Enthalpy fxrdfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1x, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcxr, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fyldfw) THEN
                rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fyldfw_host("HEAT FLUX: Enthalpy fyldfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1y, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcyl, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fyrdfw) THEN
                rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fyrdfw_host("HEAT FLUX: Enthalpy fyrdfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1y, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcyr, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fzldfw) THEN
                rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
            call heat_flux_kernel_enthalpy2_fzldfw_host("HEAT FLUX: Enthalpy fzldfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1z, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbczl, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fzrdfw) THEN
                rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
            call heat_flux_kernel_enthalpy2_fzrdfw_host("HEAT FLUX: Enthalpy fzrdfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd1z, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbczr, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF






            IF(fxldif) call zeroxl(d_wd2x)
            IF(fxrdif) call zeroxr(d_wd2x)

            IF(fyldif) call zeroyl(d_wd2y)
            IF(fyrdif) call zeroyr(d_wd2y)

            IF(fzldif) call zerozl(d_wd2z)
            IF(fzrdif) call zerozr(d_wd2z)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_MD_kernel_eqM_host("multiple math equations", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_wd2x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd2y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd2z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


            IF(fxladb) call zeroxl(d_wd2x)
            IF(fxradb) call zeroxr(d_wd2x)

            IF(fyladb) call zeroyl(d_wd2y)
            IF(fyradb) call zeroyr(d_wd2y)

            IF(fzladb) call zerozl(d_wd2z)
            IF(fzradb) call zerozr(d_wd2z)


            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqZ_host("A=A+(B+C+D)*E*F", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_wd2x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd2y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wd2z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ))

        END IF



        IF(flmixp) THEN

            rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
            call math_MD_kernel_eqG_host("A = B*C_multidim*(one-const_val/D)", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_difmix, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_wmomix, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(wmolar, nspcmx, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_ucor, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1x, 1, s3d_000, "real(8)", OPS_READ))

            call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_vcor, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1y, 1, s3d_000, "real(8)", OPS_READ))

            call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_wcor, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1z, 1, s3d_000, "real(8)", OPS_READ))




            call dfbydx(d_store7,d_store1)
            call dfbydy(d_store7,d_store2)
            call dfbydz(d_store7,d_store3)


            IF(fxldif) call zeroxl(d_store1)
            IF(fxrdif) call zeroxr(d_store1)

            IF(fyldif) call zeroyl(d_store2)
            IF(fyrdif) call zeroyr(d_store2)

            IF(fzldif) call zerozl(d_store3)
            IF(fzrdif) call zerozr(d_store3)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_MD_kernel_eqL_host("multiple math equations", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


            IF(fxladb) call zeroxl(d_store1)
            IF(fxradb) call zeroxr(d_store1)

            IF(fyladb) call zeroyl(d_store2)
            IF(fyradb) call zeroyr(d_store2)

            IF(fzladb) call zerozl(d_store3)
            IF(fzradb) call zerozr(d_store3)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqAB_host("A = A+(B*C+D*E+F*G)*H", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ))




            IF(fxldif) call zeroxl(d_store4)
            IF(fxrdif) call zeroxr(d_store4)

            IF(fyldif) call zeroyl(d_store5)
            IF(fyrdif) call zeroyr(d_store5)

            IF(fzldif) call zerozl(d_store6)
            IF(fzrdif) call zerozr(d_store6)


            IF(fxladb) call zeroxl(d_store4)
            IF(fxradb) call zeroxr(d_store4)

            IF(fyladb) call zeroyl(d_store5)
            IF(fyradb) call zeroyr(d_store5)

            IF(fzladb) call zerozl(d_store6)
            IF(fzradb) call zerozr(d_store6)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqAB_host("A = A+(B*C+D*E+F*G)*H", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store5, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store6, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ))





            IF(fxldfw) THEN
                rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fxldfw_host("HEAT FLUX: Enthalpy fxldfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1x, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcxl, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fxrdfw) THEN
                rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fxrdfw_host("HEAT FLUX: Enthalpy fxrdfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1x, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcxr, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fyldfw) THEN
                rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fyldfw_host("HEAT FLUX: Enthalpy fyldfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1y, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcyl, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fyrdfw) THEN
                rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
            call heat_flux_kernel_enthalpy2_fyrdfw_host("HEAT FLUX: Enthalpy fyrdfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1y, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbcyr, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fzldfw) THEN
                rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
            call heat_flux_kernel_enthalpy2_fzldfw_host("HEAT FLUX: Enthalpy fzldfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1z, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbczl, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fzrdfw) THEN
                rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
            call heat_flux_kernel_enthalpy2_fzrdfw_host("HEAT FLUX: Enthalpy fzrdfw", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd1z, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                              & ops_arg_gbl(acbczr, ncbcsz, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF






            IF(fxldif) call zeroxl(d_pd2x)
            IF(fxrdif) call zeroxr(d_pd2x)

            IF(fyldif) call zeroyl(d_pd2y)
            IF(fyrdif) call zeroyr(d_pd2y)

            IF(fzldif) call zerozl(d_pd2z)
            IF(fzrdif) call zerozr(d_pd2z)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_MD_kernel_eqM_host("multiple math equations", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_pd2x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd2y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd2z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


            IF(fxladb) call zeroxl(d_pd2x)
            IF(fxradb) call zeroxr(d_pd2x)

            IF(fyladb) call zeroyl(d_pd2y)
            IF(fyradb) call zeroyr(d_pd2y)

            IF(fzladb) call zerozl(d_pd2z)
            IF(fzradb) call zerozr(d_pd2z)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqZ_host("A=A+(B+C+D)*E*F", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_pd2x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd2y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_pd2z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ))

        END IF



        IF(flmsor(ispec))THEN

            rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
            call math_MD_kernel_eqF_host("A = B*C_multidim*D", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_difmix, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_ucor, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1x, 1, s3d_000, "real(8)", OPS_READ))

            call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_vcor, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1y, 1, s3d_000, "real(8)", OPS_READ))

            call math_kernel_eqN_host("A=A+B*C", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_wcor, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1z, 1, s3d_000, "real(8)", OPS_READ))




            call dfbydx(d_store7,d_store1)
            call dfbydy(d_store7,d_store2)
            call dfbydz(d_store7,d_store3)


            IF(fxldif) call zeroxl(d_store1)
            IF(fxrdif) call zeroxr(d_store1)

            IF(fyldif) call zeroyl(d_store2)
            IF(fyrdif) call zeroyr(d_store2)

            IF(fzldif) call zerozl(d_store3)
            IF(fzrdif) call zerozr(d_store3)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_MD_kernel_eqL_host("multiple math equations", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


            IF(flmduf(ispec))THEN
                rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
                call math_kernel_eqH_host("A = A-var*B*C", senga_grid, 3, rangexyz, &
                                  & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF


            IF(fxladb) call zeroxl(d_store1)
            IF(fxradb) call zeroxr(d_store1)

            IF(fyladb) call zeroyl(d_store2)
            IF(fyradb) call zeroyr(d_store2)

            IF(fzladb) call zerozl(d_store3)
            IF(fzradb) call zerozr(d_store3)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqAB_host("A = A+(B*C+D*E+F*G)*H", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ))



            call dfbydx(d_utmp,d_store4)
            call dfbydy(d_utmp,d_store5)
            call dfbydz(d_utmp,d_store6)


            IF(fxldif) call zeroxl(d_store4)
            IF(fxrdif) call zeroxr(d_store4)

            IF(fyldif) call zeroyl(d_store5)
            IF(fyrdif) call zeroyr(d_store5)

            IF(fzldif) call zerozl(d_store6)
            IF(fzrdif) call zerozr(d_store6)


            IF(fxladb) call zeroxl(d_store4)
            IF(fxradb) call zeroxr(d_store4)

            IF(fyladb) call zeroyl(d_store5)
            IF(fyradb) call zeroyr(d_store5)

            IF(fzladb) call zerozl(d_store6)
            IF(fzradb) call zerozr(d_store6)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqAB_host("A = A+(B*C+D*E+F*G)*H", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store5, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store6, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td1z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ))





            IF(fxldfw) THEN
                rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
                call heat_flux_kernel_enthalpy_fxldfw_host("HEAT FLUX: Enthalpy fxldfw", senga_grid, 3, rangexyz, &
                                  & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_store7, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_td1x, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(acbcxl, ncbcsz, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fxrdfw) THEN
                rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
                call heat_flux_kernel_enthalpy_fxrdfw_host("HEAT FLUX: Enthalpy fxrdfw", senga_grid, 3, rangexyz, &
                                  & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_store7, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_td1x, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(acbcxr, ncbcsz, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fyldfw) THEN
                rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
                call heat_flux_kernel_enthalpy_fyldfw_host("HEAT FLUX: Enthalpy fyldfw", senga_grid, 3, rangexyz, &
                                  & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_store7, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_td1y, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(acbcyl, ncbcsz, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fyrdfw) THEN
                rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
                call heat_flux_kernel_enthalpy_fyrdfw_host("HEAT FLUX: Enthalpy fyrdfw", senga_grid, 3, rangexyz, &
                                  & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_store7, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_td1y, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(acbcyr, ncbcsz, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fzldfw) THEN
                rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
                call heat_flux_kernel_enthalpy_fzldfw_host("HEAT FLUX: Enthalpy fzldfw", senga_grid, 3, rangexyz, &
                                  & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_store7, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_td1z, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(acbczl, ncbcsz, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF
            IF(fzrdfw) THEN
                rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
                call heat_flux_kernel_enthalpy_fzrdfw_host("HEAT FLUX: Enthalpy fzrdfw", senga_grid, 3, rangexyz, &
                                  & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                                  & ops_arg_dat(d_trun, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_tdrmix, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_store7, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                                  & ops_arg_dat(d_td1z, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(acbczr, ncbcsz, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                  & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

            END IF


            IF(flmduf(ispec)) THEN

                IF(fxlcnw) THEN
                    rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
                    call heat_flux_kernel_soret_fxlcnw_host("HEAT FLUX: Soret and DUFOUR fxlcnw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1x, 1, s3d_p100_to_p400_x, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbcxl, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fxrcnw) THEN
                    rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
                    call heat_flux_kernel_soret_fxrcnw_host("HEAT FLUX: Soret and DUFOUR fxrcnw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1x, 1, s3d_m100_to_m400_x, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbcxr, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fylcnw) THEN
                    rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
                    call heat_flux_kernel_soret_fylcnw_host("HEAT FLUX: Soret and DUFOUR fylcnw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1y, 1, s3d_p010_to_p040_y, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbcyl, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fyrcnw) THEN
                    rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
                    call heat_flux_kernel_soret_fyrcnw_host("HEAT FLUX: Soret and DUFOUR fyrcnw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1y, 1, s3d_m010_to_m040_y, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbcyr, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fzlcnw) THEN
                    rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
                    call heat_flux_kernel_soret_fzlcnw_host("HEAT FLUX: Soret and DUFOUR fzlcnw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1z, 1, s3d_p001_to_p004_z, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbczl, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fzrcnw) THEN
                    rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
                    call heat_flux_kernel_soret_fzrcnw_host("HEAT FLUX: Soret and DUFOUR fzrcnw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1z, 1, s3d_m001_to_m004_z, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbczr, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF


                IF(fxladw) THEN
                    rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
                    call heat_flux_kernel_isothermal_fxladw_host("HEAT FLUX: Isothermal fxladw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_000_to_p400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_000_to_p400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_000_to_p400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1x, 1, s3d_000_to_p400_x, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbcxl, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fxradw) THEN
                    rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
                    call heat_flux_kernel_isothermal_fxradw_host("HEAT FLUX: Isothermal fxradw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_000_to_m400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_000_to_m400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_000_to_m400_x, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1x, 1, s3d_000_to_m400_x, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbcxr, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fyladw) THEN
                    rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
                    call heat_flux_kernel_isothermal_fyladw_host("HEAT FLUX: Isothermal fyladw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_000_to_p040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_000_to_p040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_000_to_p040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1y, 1, s3d_000_to_p040_y, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbcyl, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fyradw) THEN
                    rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
                    call heat_flux_kernel_isothermal_fyradw_host("HEAT FLUX: Isothermal fyradw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_000_to_m040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_000_to_m040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_000_to_m040_y, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1y, 1, s3d_000_to_m040_y, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbcyr, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fzladw) THEN
                    rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
                    call heat_flux_kernel_isothermal_fzladw_host("HEAT FLUX: Isothermal fzladw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_000_to_p004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_000_to_p004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_000_to_p004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1z, 1, s3d_000_to_p004_z, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbczl, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF
                IF(fzradw)THEN
                    rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
                    call heat_flux_kernel_isothermal_fzradw_host("HEAT FLUX: Isothermal fzradw", senga_grid, 3, rangexyz, &
                                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                                      & ops_arg_dat(d_trun, 1, s3d_000_to_m004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_tdrmix, 1, s3d_000_to_m004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_store7, 1, s3d_000_to_m004_z, "real(8)", OPS_READ), &
                                      & ops_arg_dat(d_td1z, 1, s3d_000_to_m004_z, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(acbczr, ncbcsz, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(rgspec, nspcmx, "real(8)", OPS_READ), &
                                      & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

                END IF

            END IF






            IF(fxldif) call zeroxl(d_td2x)
            IF(fxrdif) call zeroxr(d_td2x)

            IF(fyldif) call zeroyl(d_td2y)
            IF(fyrdif) call zeroyr(d_td2y)

            IF(fzldif) call zerozl(d_td2z)
            IF(fzrdif) call zerozr(d_td2z)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_MD_kernel_eqM_host("multiple math equations", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_td2x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td2y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td2z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_gbl(ispec, 1, "integer", OPS_READ))


            IF(fxladb) call zeroxl(d_td2x)
            IF(fxradb) call zeroxr(d_td2x)

            IF(fyladb) call zeroyl(d_td2y)
            IF(fyradb) call zeroyr(d_td2y)

            IF(fzladb) call zerozl(d_td2z)
            IF(fzradb) call zerozr(d_td2z)

            rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
            call math_kernel_eqZ_host("A=A+(B+C+D)*E*F", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                              & ops_arg_dat(d_td2x, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td2y, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_td2z, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_utmp, 1, s3d_000, "real(8)", OPS_READ))

        END IF







    END DO






    call dfbydx(d_wtmp,d_store1)
    call dfbydy(d_wtmp,d_store2)
    call dfbydz(d_wtmp,d_store3)


    IF(fxldif) call zeroxl(d_store1)
    IF(fxrdif) call zeroxr(d_store1)

    IF(fyldif) call zeroyl(d_store2)
    IF(fyrdif) call zeroyr(d_store2)

    IF(fzldif) call zerozl(d_store3)
    IF(fzrdif) call zerozr(d_store3)


    IF(fxladb) call zeroxl(d_store1)
    IF(fxradb) call zeroxr(d_store1)

    IF(fyladb) call zeroyl(d_store2)
    IF(fyradb) call zeroyr(d_store2)

    IF(fzladb) call zerozl(d_store3)
    IF(fzradb) call zerozr(d_store3)

    rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
    call copy_kernel_host("copy", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_WRITE), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_READ))


    IF(fxladb) call zeroxl(d_store4)
    IF(fxradb) call zeroxr(d_store4)

    IF(fyladb) call zeroyl(d_store4)
    IF(fyradb) call zeroyr(d_store4)

    IF(fzladb) call zerozl(d_store4)
    IF(fzradb) call zerozr(d_store4)

    rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
    call math_kernel_eqAH_host("A = A-B*C-D*E-F*G-H*I", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(8)", OPS_INC), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_ucor, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_vcor, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                      & ops_arg_dat(d_wcor, 1, s3d_000, "real(8)", OPS_READ))






    IF(flmavt)THEN

        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_MD_kernel_eqY_host("STORE VISCOSITY IN DIFMIX", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_difmix, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(viscco, nvcfmx*nspcmx, "real(8)", OPS_READ), &
                          & ops_arg_gbl(wilko1, nspcmx*nspcmx, "real(8)", OPS_READ), &
                          & ops_arg_gbl(wilko2, nspcmx*nspcmx, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ovwmol, nspcmx, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ncovis, 1, "integer", OPS_READ), &
                          & ops_arg_gbl(ncovm1, 1, "integer", OPS_READ), &
                          & ops_arg_gbl(nspec, 1, "integer", OPS_READ))

    END IF




    DO ispec = 1,nspec


        rangexyz = (/1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz/)
        call math_MD_kernel_eqA_host("A = B_multidim", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store7, 1, s3d_000, "real(8)", OPS_WRITE), &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

        call dfbydx(d_store7,d_store1)
        call dfbydy(d_store7,d_store2)
        call dfbydz(d_store7,d_store3)


        IF(fxldif) call zeroxl(d_store1)
        IF(fxrdif) call zeroxr(d_store1)

        IF(fyldif) call zeroyl(d_store2)
        IF(fyrdif) call zeroyr(d_store2)

        IF(fzldif) call zerozl(d_store3)
        IF(fzrdif) call zerozr(d_store3)


        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call math_MD_kernel_eqK_host("A_multidim = B_multidim - A_multidim*C - D*E - F*G - H*I", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_yrhs, 9, s3d_000, "real(8)", OPS_RW), &
                          & ops_arg_dat(d_rate, 9, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_vtmp, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_ucor, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_vcor, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_dat(d_wcor, 1, s3d_000, "real(8)", OPS_READ), &
                          & ops_arg_gbl(ispec, 1, "integer", OPS_READ))

    END DO











    IF(fxlcnv.OR.fxrcnv) THEN

        call dfbydx(d_drhs,d_store1)

        IF(fxlcnv) THEN
            rangexyz = (/1,1,1,nyglbl,1,nzglbl/)
            call boundary_kernel_density_xdir_host("COLLECT DENSITY AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strdxl, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bcl2xl, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE))

        END IF
        IF(fxrcnv) THEN
            rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,nzglbl/)
            call boundary_kernel_density_xdir_host("COLLECT DENSITY AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store1, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strdxr, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bcl2xr, 1, s3d_000_strid3d_yz, "real(8)", OPS_WRITE))

        END IF

    END IF

    IF(fylcnv.OR.fyrcnv) THEN

        call dfbydy(d_drhs,d_store2)

        IF(fylcnv) THEN
            rangexyz = (/1,nxglbl,1,1,1,nzglbl/)
            call boundary_kernel_density_ydir_host("COLLECT DENSITY AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strdyl, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bcl2yl, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE))

        END IF
        IF(fyrcnv) THEN
            rangexyz = (/1,nxglbl,nyglbl,nyglbl,1,nzglbl/)
            call boundary_kernel_density_ydir_host("COLLECT DENSITY AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store2, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strdyr, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bcl2yr, 1, s3d_000_strid3d_xz, "real(8)", OPS_WRITE))

        END IF

    END IF

    IF(fzlcnv.OR.fzrcnv) THEN

        call dfbydz(d_drhs,d_store3)

        IF(fzlcnv) THEN
            rangexyz = (/1,nxglbl,1,nyglbl,1,1/)
            call boundary_kernel_density_zdir_host("COLLECT DENSITY AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strdzl, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bcl2zl, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE))

        END IF
        IF(fzrcnv) THEN
            rangexyz = (/1,nxglbl,1,nyglbl,nzglbl,nzglbl/)
            call boundary_kernel_density_zdir_host("COLLECT DENSITY AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(d_drhs, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_store3, 1, s3d_000, "real(8)", OPS_READ), &
                              & ops_arg_dat(d_strdzr, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE), &
                              & ops_arg_dat(d_bcl2zr, 1, s3d_000_strid3d_xy, "real(8)", OPS_WRITE))

        END IF

    END IF


END SUBROUTINE rhscal
