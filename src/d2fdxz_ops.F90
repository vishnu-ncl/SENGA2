!
! auto-generated by ops_fortran.py
!
SUBROUTINE d2fdxz(functn,fderiv)
 use OPS_Fortran_Declarations
  use OPS_Fortran_RT_Support
  use D2FDXZ_KERNEL_NULL_MODULE
  use D2FDXZ_KERNEL_INTERIOR_MODULE
  use D2FDXZ_KERNEL_LH_XDIR_4TH_ONESIDED_MODULE
  use D2FDXZ_KERNEL_LH_XDIR_4TH_MIXED_MODULE
  use D2FDXZ_KERNEL_LH_XDIR_4TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_LH_XDIR_6TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_LH_XDIR_8TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_RH_XDIR_8TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_RH_XDIR_6TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_RH_XDIR_4TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_RH_XDIR_4TH_MIXED_MODULE
  use D2FDXZ_KERNEL_RH_XDIR_4TH_ONESIDED_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_4TH_ONESIDED_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_4TH_MIXED_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_4TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_6TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_8TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQA_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQB_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQC_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQD_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQE_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQF_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQG_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQH_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQI_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQL_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQM_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQN_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQO_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQP_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQQ_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQR_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQS_MODULE
  use D2FDXZ_KERNEL_LH_ZDIR_CORNER_EQT_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_8TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_6TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_4TH_CENTERED_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_4TH_MIXED_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_4TH_ONESIDED_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQA_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQB_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQC_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQD_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQE_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQF_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQG_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQH_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQI_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQL_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQM_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQN_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQO_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQP_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQQ_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQR_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQS_MODULE
  use D2FDXZ_KERNEL_RH_ZDIR_CORNER_EQT_MODULE
  use D2FDXZ_KERNEL_SCALING_MODULE

    use OPS_CONSTANTS
    use, intrinsic :: ISO_C_BINDING

    use data_types
    use com_senga
    use com_ops_senga













    TYPE(ops_dat) :: functn, fderiv


    integer :: rangexyz(6)
    integer :: istart,ifinis,kstart,kfinis



    IF (nxglbl==1 .or. nzglbl==1) THEN
        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call d2fdxz_kernel_null_host("d2fdxz_null", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

    ELSE



        istart = 1
        ifinis = nxglbl
        kstart = 1
        kfinis = nzglbl
        IF(nendxl == nbound) istart = 6
        IF(nendxr == nbound) ifinis = nxglbl-5
        IF(nendzl == nbound) kstart = 6
        IF(nendzr == nbound) kfinis = nzglbl-5


        rangexyz = (/istart,ifinis,1,nyglbl,kstart,kfinis/)
        call d2fdxz_kernel_interior_host("d2fdxz_interior", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(functn, 1, s3d_p505_m505_mixed_xz, "real(8)", OPS_READ), &
                          & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))



        IF(nendxl == nbound) THEN

            rangexyz = (/1,1,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_lh_xdir_4th_onesided_host("d2fdxz_lh_xdir_4th_onesided", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p402_m002_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/2,2,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_lh_xdir_4th_mixed_host("d2fdxz_lh_xdir_4th_mixed", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p302_m102_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/3,3,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_lh_xdir_4th_centered_host("d2fdxz_lh_xdir_4th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p202_m202_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/4,4,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_lh_xdir_6th_centered_host("d2fdxz_lh_xdir_6th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p303_m303_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/5,5,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_lh_xdir_8th_centered_host("d2fdxz_lh_xdir_8th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p404_m404_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

        END IF



        IF(nendxr == nbound) THEN

            rangexyz = (/nxglbl-4,nxglbl-4,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_rh_xdir_8th_centered_host("d2fdxz_rh_xdir_8th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p404_m404_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-3,nxglbl-3,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_rh_xdir_6th_centered_host("d2fdxz_rh_xdir_6th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p303_m303_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-2,nxglbl-2,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_rh_xdir_4th_centered_host("d2fdxz_rh_xdir_4th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p202_m202_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-1,nxglbl-1,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_rh_xdir_4th_mixed_host("d2fdxz_rh_xdir_4th_mixed", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p102_m302_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl,nxglbl,1,nyglbl,kstart,kfinis/)
            call d2fdxz_kernel_rh_xdir_4th_onesided_host("d2fdxz_rh_xdir_4th_onesided", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p002_m402_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

        END IF



        IF(nendxl == nbound) THEN

            rangexyz = (/istart,ifinis,1,nyglbl,1,1/)
            call d2fdxz_kernel_lh_zdir_4th_onesided_host("d2fdxz_lh_zdir_4th_onesided", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p204_m200_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/istart,ifinis,1,nyglbl,2,2/)
            call d2fdxz_kernel_lh_zdir_4th_mixed_host("d2fdxz_lh_zdir_4th_mixed", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p203_m201_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/istart,ifinis,1,nyglbl,3,3/)
            call d2fdxz_kernel_lh_zdir_4th_centered_host("d2fdxz_lh_zdir_4th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p202_m202_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/istart,ifinis,1,nyglbl,4,4/)
            call d2fdxz_kernel_lh_zdir_6th_centered_host("d2fdxz_lh_zdir_6th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p303_m303_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/istart,ifinis,1,nyglbl,5,5/)
            call d2fdxz_kernel_lh_zdir_8th_centered_host("d2fdxz_lh_zdir_8th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p404_m404_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))


            IF(nendxl == nbound) THEN
            rangexyz = (/1,1,1,nyglbl,1,1/)
            call d2fdxz_kernel_lh_zdir_corner_eqA_host("d2fdxz_lh_zdir_corner_eqA", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p404_p000_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/2,2,1,nyglbl,2,2/)
            call d2fdxz_kernel_lh_zdir_corner_eqB_host("d2fdxz_lh_zdir_corner_eqB", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p303_m101_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/1,1,1,nyglbl,2,2/)
            call d2fdxz_kernel_lh_zdir_corner_eqC_host("d2fdxz_lh_zdir_corner_eqC", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p403_m001_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/2,2,1,nyglbl,1,1/)
            call d2fdxz_kernel_lh_zdir_corner_eqD_host("d2fdxz_lh_zdir_corner_eqD", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p304_m100_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/3,5,1,nyglbl,1,1/)
            call d2fdxz_kernel_lh_zdir_corner_eqE_host("d2fdxz_lh_zdir_corner_eqE", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p204_m200_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/3,5,1,nyglbl,2,2/)
            call d2fdxz_kernel_lh_zdir_corner_eqF_host("d2fdxz_lh_zdir_corner_eqF", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p203_m201_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/1,1,1,nyglbl,3,5/)
            call d2fdxz_kernel_lh_zdir_corner_eqG_host("d2fdxz_lh_zdir_corner_eqG", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p402_m002_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/2,2,1,nyglbl,3,5/)
            call d2fdxz_kernel_lh_zdir_corner_eqH_host("d2fdxz_lh_zdir_corner_eqH", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p302_m102_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/3,5,1,nyglbl,3,5/)
            call d2fdxz_kernel_lh_zdir_corner_eqI_host("d2fdxz_lh_zdir_corner_eqI", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p404_m404_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE), &
                              & ops_arg_idx())

            END IF


            IF(nendxr == nbound)THEN
            rangexyz = (/nxglbl,nxglbl,1,nyglbl,1,1/)
            call d2fdxz_kernel_lh_zdir_corner_eqL_host("d2fdxz_lh_zdir_corner_eqL", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p004_m400_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-1,nxglbl-1,1,nyglbl,2,2/)
            call d2fdxz_kernel_lh_zdir_corner_eqM_host("d2fdxz_lh_zdir_corner_eqM", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p100_m300_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl,nxglbl,1,nyglbl,2,2/)
            call d2fdxz_kernel_lh_zdir_corner_eqN_host("d2fdxz_lh_zdir_corner_eqN", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p003_m401_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-1,nxglbl-1,1,nyglbl,1,1/)
            call d2fdxz_kernel_lh_zdir_corner_eqO_host("d2fdxz_lh_zdir_corner_eqO", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p104_m300_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-4,nxglbl-2,1,nyglbl,1,1/)
            call d2fdxz_kernel_lh_zdir_corner_eqP_host("d2fdxz_lh_zdir_corner_eqP", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p204_m200_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-4,nxglbl-2,1,nyglbl,2,2/)
            call d2fdxz_kernel_lh_zdir_corner_eqQ_host("d2fdxz_lh_zdir_corner_eqQ", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p203_m201_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl,nxglbl,1,nyglbl,3,5/)
            call d2fdxz_kernel_lh_zdir_corner_eqR_host("d2fdxz_lh_zdir_corner_eqR", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p002_m402_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-1,nxglbl-1,1,nyglbl,3,5/)
            call d2fdxz_kernel_lh_zdir_corner_eqS_host("d2fdxz_lh_zdir_corner_eqS", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p102_m302_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-4,nxglbl-2,1,nyglbl,3,5/)
            call d2fdxz_kernel_lh_zdir_corner_eqT_host("d2fdxz_lh_zdir_corner_eqT", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p404_m404_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(nxglbl, 1, "integer", OPS_READ), &
                              & ops_arg_idx())

            END IF

        END IF



        IF(nendzr == nbound) THEN

            rangexyz = (/istart,ifinis,1,nyglbl,nzglbl-4,nzglbl-4/)
            call d2fdxz_kernel_rh_zdir_8th_centered_host("d2fdxz_rh_zdir_8th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p404_m404_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/istart,ifinis,1,nyglbl,nzglbl-3,nzglbl-3/)
            call d2fdxz_kernel_rh_zdir_6th_centered_host("d2fdxz_rh_zdir_6th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p303_m303_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/istart,ifinis,1,nyglbl,nzglbl-2,nzglbl-2/)
            call d2fdxz_kernel_rh_zdir_4th_centered_host("d2fdxz_rh_zdir_4th_centered", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p202_m202_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/istart,ifinis,1,nyglbl,nzglbl-1,nzglbl-1/)
            call d2fdxz_kernel_rh_zdir_4th_mixed_host("d2fdxz_rh_zdir_4th_mixed", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p201_m203_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/istart,ifinis,1,nyglbl,nzglbl,nzglbl/)
            call d2fdxz_kernel_rh_zdir_4th_onesided_host("d2fdxz_rh_zdir_4th_onesided", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p200_m204_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))


            IF(nendxl == nbound) THEN
            rangexyz = (/1,1,1,nyglbl,nzglbl,nzglbl/)
            call d2fdxz_kernel_rh_zdir_corner_eqA_host("d2fdxz_rh_zdir_corner_eqA", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p400_p004_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/2,2,1,nyglbl,nzglbl-1,nzglbl-1/)
            call d2fdxz_kernel_rh_zdir_corner_eqB_host("d2fdxz_rh_zdir_corner_eqB", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p300_m100_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/1,1,1,nyglbl,nzglbl-1,nzglbl-1/)
            call d2fdxz_kernel_rh_zdir_corner_eqC_host("d2fdxz_rh_zdir_corner_eqC", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p401_p003_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/2,2,1,nyglbl,nzglbl,nzglbl/)
            call d2fdxz_kernel_rh_zdir_corner_eqD_host("d2fdxz_rh_zdir_corner_eqD", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p300_m104_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/3,5,1,nyglbl,nzglbl-1,nzglbl-1/)
            call d2fdxz_kernel_rh_zdir_corner_eqE_host("d2fdxz_rh_zdir_corner_eqE", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p201_m203_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/3,5,1,nyglbl,nzglbl,nzglbl/)
            call d2fdxz_kernel_rh_zdir_corner_eqF_host("d2fdxz_rh_zdir_corner_eqF", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p200_m204_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/1,1,1,nyglbl,nzglbl-4,nzglbl-2/)
            call d2fdxz_kernel_rh_zdir_corner_eqG_host("d2fdxz_rh_zdir_corner_eqG", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p402_m002_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/2,2,1,nyglbl,nzglbl-4,nzglbl-2/)
            call d2fdxz_kernel_rh_zdir_corner_eqH_host("d2fdxz_rh_zdir_corner_eqH", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p302_m102_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/3,5,1,nyglbl,nzglbl-4,nzglbl-2/)
            call d2fdxz_kernel_rh_zdir_corner_eqI_host("d2fdxz_rh_zdir_corner_eqI", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p404_m404_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(nzglbl, 1, "integer", OPS_READ), &
                              & ops_arg_idx())

            END IF


            IF(nendxr == nbound) THEN
            rangexyz = (/nxglbl,nxglbl,1,nyglbl,nzglbl,nzglbl/)
            call d2fdxz_kernel_rh_zdir_corner_eqL_host("d2fdxz_rh_zdir_corner_eqL", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p000_m404_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-1,nxglbl-1,1,nyglbl,nzglbl-1,nzglbl-1/)
            call d2fdxz_kernel_rh_zdir_corner_eqM_host("d2fdxz_rh_zdir_corner_eqM", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p101_m303_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl,nxglbl,1,nyglbl,nzglbl-1,nzglbl-1/)
            call d2fdxz_kernel_rh_zdir_corner_eqN_host("d2fdxz_rh_zdir_corner_eqN", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p001_m403_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-1,nxglbl-1,1,nyglbl,nzglbl,nzglbl/)
            call d2fdxz_kernel_rh_zdir_corner_eqO_host("d2fdxz_rh_zdir_corner_eqO", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p100_m304_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-4,nxglbl-2,1,nyglbl,nzglbl-1,nzglbl-1/)
            call d2fdxz_kernel_rh_zdir_corner_eqP_host("d2fdxz_rh_zdir_corner_eqP", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p201_m203_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-4,nxglbl-2,1,nyglbl,nzglbl,nzglbl/)
            call d2fdxz_kernel_rh_zdir_corner_eqQ_host("d2fdxz_rh_zdir_corner_eqQ", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p200_m204_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl,nxglbl,1,nyglbl,nzglbl-4,nzglbl-2/)
            call d2fdxz_kernel_rh_zdir_corner_eqR_host("d2fdxz_rh_zdir_corner_eqR", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p002_m402_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-1,nxglbl-1,1,nyglbl,nzglbl-4,nzglbl-2/)
            call d2fdxz_kernel_rh_zdir_corner_eqS_host("d2fdxz_rh_zdir_corner_eqS", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p102_m302_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE))

            rangexyz = (/nxglbl-4,nxglbl-2,1,nyglbl,nzglbl-4,nzglbl-2/)
            call d2fdxz_kernel_rh_zdir_corner_eqT_host("d2fdxz_rh_zdir_corner_eqT", senga_grid, 3, rangexyz, &
                              & ops_arg_dat(functn, 1, s3d_p404_m404_mixed_xz, "real(8)", OPS_READ), &
                              & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_WRITE), &
                              & ops_arg_gbl(nxglbl, 1, "integer", OPS_READ), &
                              & ops_arg_gbl(nzglbl, 1, "integer", OPS_READ), &
                              & ops_arg_idx())

            END IF

        END IF



        rangexyz = (/1,nxglbl,1,nyglbl,1,nzglbl/)
        call d2fdxz_kernel_scaling_host("d2fdxz_scaling", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(fderiv, 1, s3d_000, "real(8)", OPS_RW))

    END IF


END SUBROUTINE d2fdxz
