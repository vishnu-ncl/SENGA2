!
! auto-generated by ops_fortran.py
!
SUBROUTINE chemin

    use OPS_Fortran_Declarations
  use OPS_Fortran_RT_Support

    use OPS_CONSTANTS
    use, intrinsic :: ISO_C_BINDING

    use data_types
    use com_senga
    use com_ops_senga















    real(kind=8) :: pcount
    real(kind=8) :: giblet
    INTEGER :: ispec,istep,ibody,ilind,itroe,isrif
    INTEGER :: jspec,jstep,jbody,jlind,jtroe,jsrif
    INTEGER :: itint,icp
    INTEGER :: ncount
    INTEGER :: iroot












































    iroot = 0

    pcount = zero

    DO ncount = 1, nparay
        parray(ncount) = zero
    END DO


    IF(iproc == 0)THEN




        OPEN(UNIT=ncchem,FILE=fnchem,STATUS='OLD',FORM='FORMATTED')



            READ(ncchem,*)
            READ(ncchem,*)
            READ(ncchem,*)
            READ(ncchem,*)
            READ(ncchem,*)



            READ(ncchem,*)
            READ(ncchem,'(I5)')nspec
            DO jspec = 1, nspec
                READ(ncchem,'(I5,3X,A)')ispec,spcsym(ispec)
            END DO


            READ(ncchem,*)
            READ(ncchem,*)prefgb
            DO jspec = 1,nspec
                READ(ncchem,'(I5,1PE12.4)')ispec,wmolar(ispec)
                READ(ncchem,'(1PE12.4)')clewis(ispec)
                READ(ncchem,'(I5)')ntint(ispec)
                DO itint = 1,ntint(ispec)
                    READ(ncchem,'(2(1PE12.4),I5)')tintlo(itint,ispec),  &
                                        tinthi(itint,ispec),ncofcp(itint,ispec)
                    DO icp = 1,ncofcp(itint,ispec)
                        READ(ncchem,'(1PE15.7)')amolcp(icp,itint,ispec)
                    END DO
                END DO
            END DO



            READ(ncchem,*)
            READ(ncchem,'(I5)')nstep
            DO jstep = 1, nstep
                READ(ncchem,'(I5,3(1PE12.4))')istep,(rparam(icp,istep),icp=1,3)
            END DO



            READ(ncchem,*)
            DO jstep = 1,nstep
                READ(ncchem,'(2I5)')istep,nsslen(istep)
                DO jspec = 1, nsslen(istep)
                    READ(ncchem,'(2I5,I8)')istep,ispec,nsspec(ispec,istep)
                END DO
            END DO


            READ(ncchem,*)
            DO jstep = 1,nstep
                READ(ncchem,'(2I5)')istep,nrslen(istep)
                DO jspec = 1, nrslen(istep)
                    READ(ncchem,'(2I5,I8)')istep,ispec,nrspec(ispec,istep)
                END DO
            END DO


            READ(ncchem,*)
            DO jstep = 1,nstep
                READ(ncchem,'(2I5)')istep,npslen(istep)
                DO jspec = 1, npslen(istep)
                    READ(ncchem,'(2I5,I8)')istep,ispec,npspec(ispec,istep)
                END DO
            END DO


            READ(ncchem,*)
            DO jstep = 1,nstep
                READ(ncchem,'(2I5)')istep,nrclen(istep)
                DO jspec = 1, nrclen(istep)
                    READ(ncchem,'(2I5,I8,1PE12.4)')istep,ispec,  &
                                nrcpec(ispec,istep),crspec(ispec,istep)
                END DO
            END DO


            READ(ncchem,*)
            DO jstep = 1,nstep
                READ(ncchem,'(2I5)')istep,npclen(istep)
                DO jspec = 1, npclen(istep)
                    READ(ncchem,'(2I5,I8,1PE12.4)')istep,ispec,  &
                                npcpec(ispec,istep),cpspec(ispec,istep)
                END DO
            END DO


            READ(ncchem,*)
            DO jstep = 1,nstep
                DO jspec = 1,nsslen(jstep)
                    READ(ncchem,'(2I5,F5.1)')istep,ispec,diffmu(ispec,istep)
                END DO
            END DO



            READ(ncchem,*)
            READ(ncchem,'(I5)')nbody
            DO jbody = 1, nbody
                READ(ncchem,'(I5,3X,A)')ibody,bdysym(ibody)
            END DO


            READ(ncchem,*)
            IF(nbody > 0) THEN
                DO jstep = 1, nstep
                    READ(ncchem,'(I5,I8)')istep,mblist(istep)
                END DO
            END IF


            READ(ncchem,*)
            DO jbody = 1,nbody
                DO jspec = 1,nspec
                    READ(ncchem,'(2I5,1PE12.4)')ibody,ispec,effy3b(ispec,ibody)
                END DO
            END DO



            READ(ncchem,*)
            READ(ncchem,'(I5)')ngibb
            IF(ngibb > 0) THEN
                DO jstep = 1, nstep
                    READ(ncchem,'(I5,I8)')istep,mglist(istep)
                END DO
            END IF



            READ(ncchem,*)
            READ(ncchem,'(I5)')nlind
            IF(nlind > 0) THEN
                DO jstep = 1, nstep
                    READ(ncchem,'(I5,I8)')istep,mllist(istep)
                END DO
            END IF


            READ(ncchem,*)
            DO jlind = 1, nlind
                READ(ncchem,'(I5,4(1PE12.4))')ilind,(rclind(icp,ilind),icp=1,4)
            END DO



            READ(ncchem,*)
            READ(ncchem,'(I5)')ntroe
            IF(ntroe > 0) THEN
                DO jstep = 1, nstep
                    READ(ncchem,'(I5,I8)')istep,mtlist(istep)
                END DO
            END IF


            READ(ncchem,*)
            DO jtroe = 1, ntroe
                READ(ncchem,'(I5,6(1PE12.4))')itroe,(rctroe(icp,itroe),icp=1,6)
                READ(ncchem,'(I5,6(1PE12.4))')itroe,(rctroe(icp,itroe),icp=7,12)
            END DO



            READ(ncchem,*)
            READ(ncchem,'(I5)')nsrif
            IF(nsrif > 0) THEN
                DO jstep = 1, nstep
                    READ(ncchem,'(I5,I8)')istep,mslist(istep)
                END DO
            END IF


            READ(ncchem,*)
            DO jsrif = 1, nsrif
                READ(ncchem,'(I5,3(1PE12.4))')isrif,(rcsrif(icp,isrif),icp=1,3)
                READ(ncchem,'(I5,5(1PE12.4))')isrif,(rcsrif(icp,isrif),icp=4,8)
            END DO



            READ(ncchem,*)
        CLOSE(ncchem)





        ncount = 1
        parray(ncount) = REAL(nspec,kind=8)


        DO ispec = 1,nspec
            DO icp = 1, nspstr
                ncount = ncount + 1
                parray(ncount) = REAL(ICHAR(spcsym(ispec)(icp:icp)),kind=8)
            END DO
        END DO


        ncount = ncount + 1
        parray(ncount) = prefgb
        DO ispec = 1,nspec
            ncount = ncount + 1
            parray(ncount) = wmolar(ispec)
            ncount = ncount + 1
            parray(ncount) = clewis(ispec)
            ncount = ncount + 1
            parray(ncount) = REAL(ntint(ispec),kind=8)
            DO itint = 1,ntint(ispec)
                ncount = ncount + 1
                parray(ncount) = tintlo(itint,ispec)
                ncount = ncount + 1
                parray(ncount) = tinthi(itint,ispec)
                ncount = ncount + 1
                parray(ncount) = REAL(ncofcp(itint,ispec),kind=8)
                DO icp = 1,ncofcp(itint,ispec)
                    ncount = ncount + 1
                    parray(ncount) = amolcp(icp,itint,ispec)
                END DO
            END DO
        END DO



        ncount = ncount + 1
        parray(ncount) = REAL(nstep,kind=8)


        DO istep = 1, nstep
            DO icp = 1,3
                ncount = ncount + 1
                parray(ncount) = rparam(icp,istep)
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            parray(ncount) = REAL(nsslen(istep),kind=8)
            DO ispec = 1, nsslen(istep)
                ncount = ncount + 1
                parray(ncount) = REAL(nsspec(ispec,istep),kind=8)
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            parray(ncount) = REAL(nrslen(istep),kind=8)
            DO ispec = 1, nrslen(istep)
                ncount = ncount + 1
                parray(ncount) = REAL(nrspec(ispec,istep),kind=8)
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            parray(ncount) = REAL(npslen(istep),kind=8)
            DO ispec = 1, npslen(istep)
                ncount = ncount + 1
                parray(ncount) = REAL(npspec(ispec,istep),kind=8)
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            parray(ncount) = REAL(nrclen(istep),kind=8)
            DO ispec = 1, nrclen(istep)
                ncount = ncount + 1
                parray(ncount) = REAL(nrcpec(ispec,istep),kind=8)
                ncount = ncount + 1
                parray(ncount) = crspec(ispec,istep)
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            parray(ncount) = REAL(npclen(istep),kind=8)
            DO ispec = 1, npclen(istep)
                ncount = ncount + 1
                parray(ncount) = REAL(npcpec(ispec,istep),kind=8)
                ncount = ncount + 1
                parray(ncount) = cpspec(ispec,istep)
            END DO
        END DO


        DO istep = 1,nstep
            DO ispec = 1, nsslen(istep)
                ncount = ncount + 1
                parray(ncount) = diffmu(ispec,istep)
            END DO
        END DO



        ncount = ncount + 1
        parray(ncount) = REAL(nbody,kind=8)
        DO ibody = 1, nbody
            DO icp = 1, nspstr
                ncount = ncount + 1
                parray(ncount) = REAL(ICHAR(bdysym(ibody)(icp:icp)),kind=8)
            END DO
        END DO


        IF(nbody > 0)THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                parray(ncount) = REAL(mblist(istep),kind=8)
            END DO
        END IF


        DO ibody = 1, nbody
            DO ispec = 1,nspec
                ncount = ncount + 1
                parray(ncount) = effy3b(ispec,ibody)
            END DO
        END DO



        ncount = ncount + 1
        parray(ncount) = REAL(ngibb,kind=8)
        IF(ngibb > 0) THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                parray(ncount) = REAL(mglist(istep),kind=8)
            END DO
        END IF



        ncount = ncount + 1
        parray(ncount) = REAL(nlind,kind=8)
        IF(nlind > 0) THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                parray(ncount) = REAL(mllist(istep),kind=8)
            END DO
        END IF


        DO ilind = 1, nlind
            DO icp = 1,4
                ncount = ncount + 1
                parray(ncount) = rclind(icp,ilind)
            END DO
        END DO



        ncount = ncount + 1
        parray(ncount) = REAL(ntroe,kind=8)
        IF(ntroe > 0) THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                parray(ncount) = REAL(mtlist(istep),kind=8)
            END DO
        END IF


        DO itroe = 1, ntroe
            DO icp = 1,12
                ncount = ncount + 1
                parray(ncount) = rctroe(icp,itroe)
            END DO
        END DO



        ncount = ncount + 1
        parray(ncount) = REAL(nsrif,kind=8)
        IF(nsrif > 0) THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                parray(ncount) = REAL(mslist(istep),kind=8)
            END DO
        END IF


        DO isrif = 1, nsrif
            DO icp = 1,8
                ncount = ncount + 1
                parray(ncount) = rcsrif(icp,isrif)
            END DO
        END DO



        pcount = REAL(ncount,kind=8)


        IF(ncount > nparay) THEN
            WRITE(ncrept,*)
            WRITE(ncrept,*)'Warning: CHEMIN: broadcast array size too small'
            WRITE(ncrept,*)'Actual: ',ncount,'; Available: ',nparay
            WRITE(ncrept,*)
        END IF


    END IF



    call p_bcst(pcount,1,1,iroot)
    ncount = nint(pcount)


    call p_bcst(parray,nparay,ncount,iroot)


    IF(iproc /= 0) THEN





        ncount = 1
        nspec = nint(parray(ncount))


        DO ispec = 1,nspec
            DO icp = 1, nspstr
                ncount = ncount + 1
                spcsym(ispec)(icp:icp) = CHAR(nint(parray(ncount)))
            END DO
        END DO


        ncount = ncount + 1
        prefgb = parray(ncount)
        DO ispec = 1,nspec
            ncount = ncount + 1
            wmolar(ispec) = parray(ncount)
            ncount = ncount + 1
            clewis(ispec) = parray(ncount)
            ncount = ncount + 1
            ntint(ispec) = nint(parray(ncount))
            DO itint = 1,ntint(ispec)
                ncount = ncount + 1
                tintlo(itint,ispec) = parray(ncount)
                ncount = ncount + 1
                tinthi(itint,ispec) = parray(ncount)
                ncount = ncount + 1
                ncofcp(itint,ispec) = nint(parray(ncount))
                DO icp = 1,ncofcp(itint,ispec)
                    ncount = ncount + 1
                    amolcp(icp,itint,ispec) = parray(ncount)
                END DO
            END DO
        END DO



        ncount = ncount + 1
        nstep = nint(parray(ncount))


        DO istep = 1, nstep
            DO icp = 1,3
                ncount = ncount + 1
                rparam(icp,istep) = parray(ncount)
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            nsslen(istep) = nint(parray(ncount))
            DO ispec = 1, nsslen(istep)
                ncount = ncount + 1
                nsspec(ispec,istep) = nint(parray(ncount))
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            nrslen(istep) = nint(parray(ncount))
            DO ispec = 1, nrslen(istep)
                ncount = ncount + 1
                nrspec(ispec,istep) = nint(parray(ncount))
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            npslen(istep) = nint(parray(ncount))
            DO ispec = 1, npslen(istep)
                ncount = ncount + 1
                npspec(ispec,istep) = nint(parray(ncount))
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            nrclen(istep) = nint(parray(ncount))
            DO ispec = 1, nrclen(istep)
                ncount = ncount + 1
                nrcpec(ispec,istep) = nint(parray(ncount))
                ncount = ncount + 1
                crspec(ispec,istep) = parray(ncount)
            END DO
        END DO


        DO istep = 1,nstep
            ncount = ncount + 1
            npclen(istep) = nint(parray(ncount))
            DO ispec = 1, npclen(istep)
                ncount = ncount + 1
                npcpec(ispec,istep) = nint(parray(ncount))
                ncount = ncount + 1
                cpspec(ispec,istep) = parray(ncount)
            END DO
        END DO


        DO istep = 1,nstep
            DO ispec = 1, nsslen(istep)
                ncount = ncount + 1
                diffmu(ispec,istep) = parray(ncount)
            END DO
        END DO



        ncount = ncount + 1
        nbody = nint(parray(ncount))
        DO ibody = 1, nbody
            DO icp = 1, nspstr
                ncount = ncount + 1
                bdysym(ibody)(icp:icp) = CHAR(nint(parray(ncount)))
            END DO
        END DO


        IF(nbody > 0) THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                mblist(istep) = nint(parray(ncount))
            END DO
        END IF


        DO ibody = 1, nbody
            DO ispec = 1,nspec
                ncount = ncount + 1
                effy3b(ispec,ibody) = parray(ncount)
            END DO
        END DO



        ncount = ncount + 1
        ngibb = nint(parray(ncount))
        IF(ngibb > 0) THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                mglist(istep) = nint(parray(ncount))
            END DO
        END IF



        ncount = ncount + 1
        nlind = nint(parray(ncount))
        IF(nlind > 0) THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                mllist(istep) = nint(parray(ncount))
            END DO
        END IF


        DO ilind = 1, nlind
            DO icp = 1,4
                ncount = ncount + 1
                rclind(icp,ilind) = parray(ncount)
            END DO
        END DO



        ncount = ncount + 1
        ntroe = nint(parray(ncount))
        IF(ntroe > 0) THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                mtlist(istep) = nint(parray(ncount))
            END DO
        END IF


        DO itroe = 1, ntroe
            DO icp = 1,12
                ncount = ncount + 1
                rctroe(icp,itroe) = parray(ncount)
            END DO
        END DO



        ncount = ncount + 1
        nsrif = nint(parray(ncount))
        IF(nsrif > 0) THEN
            DO istep = 1, nstep
                ncount = ncount + 1
                mslist(istep) = nint(parray(ncount))
            END DO
        END IF


        DO isrif = 1, nsrif
            DO icp = 1,8
                ncount = ncount + 1
                rcsrif(icp,isrif) = parray(ncount)
            END DO
        END DO


    END IF




    nspm1 = nspec - 1


    DO istep = 1,nstep
        rparam(1,istep) = LOG(rparam(1,istep))
        rparam(3,istep) = rparam(3,istep)/rguniv
    END DO

    DO ilind = 1, nlind
        rclind(1,ilind) = LOG(rclind(1,ilind))
        rclind(3,ilind) = rclind(3,ilind)/rguniv
    END DO

    DO itroe = 1, ntroe
        rctroe(1,itroe) = LOG(rctroe(1,itroe))
        rctroe(3,itroe) = rctroe(3,itroe)/rguniv
        rctroe(5,itroe) = one/rctroe(5,itroe)
        rctroe(7,itroe) = -one/rctroe(7,itroe)
    END DO

    DO isrif = 1, nsrif
        rcsrif(1,isrif) = LOG(rcsrif(1,isrif))
        rcsrif(3,isrif) = rcsrif(3,isrif)/rguniv
        rcsrif(5,isrif) = -rcsrif(5,isrif)
        rcsrif(6,isrif) = -one/rcsrif(6,isrif)
    END DO


    DO istep = 1,nstep
        DO ispec = 1,nsslen(istep)
            jspec = nsspec(ispec,istep)
            diffmw(ispec,istep) = diffmu(ispec,istep)*wmolar(jspec)
        END DO
    END DO



    DO ispec = 1,nspec
        ovwmol(ispec) = one/wmolar(ispec)
        rgspec(ispec) = rguniv*ovwmol(ispec)
    END DO





    DO ispec = 1,nspec
        DO itint = 1,ntint(ispec)
            ncpoly(itint,ispec) = ncofcp(itint,ispec)-2
            ncpom1(itint,ispec) = ncpoly(itint,ispec)-1
            ncenth(itint,ispec) = ncofcp(itint,ispec)-1
            ncenpy(itint,ispec) = ncofcp(itint,ispec)
        END DO
    END DO

    DO ispec = 1,nspec
        DO itint = 1,ntint(ispec)
            DO icp = 1,ncofcp(itint,ispec)
                amascp(icp,itint,ispec) = amolcp(icp,itint,ispec)*rguniv*ovwmol(ispec)
            END DO
        END DO
    END DO

    DO ispec = 1,nspec
        DO itint = 1,ntint(ispec)
            amasct(1,itint,ispec) = amascp(1,itint,ispec) - rgspec(ispec)
            DO icp = 2,ncpoly(itint,ispec)
                amasct(icp,itint,ispec) = amascp(icp,itint,ispec)/REAL(icp,kind=8)
            END DO
            amasct(ncenth(itint,ispec),itint,ispec) = zero
            amasct(ncenpy(itint,ispec),itint,ispec) = zero
        END DO
    END DO

    DO ispec = 1,nspec
        DO itint = 1,ntint(ispec)
            amasch(1,itint,ispec) = amascp(1,itint,ispec)
            DO icp = 2,ncpoly(itint,ispec)
                amasch(icp,itint,ispec) = amascp(icp,itint,ispec)/REAL(icp,kind=8)
            END DO
            amasch(ncenth(itint,ispec),itint,ispec)  &
                = amascp(ncenth(itint,ispec),itint,ispec)
            amasch(ncenpy(itint,ispec),itint,ispec) = zero
        END DO
    END DO

    DO ispec = 1,nspec
        DO itint = 1,ntint(ispec)
            amascs(1,itint,ispec) = amascp(1,itint,ispec)
            DO icp = 2,ncpoly(itint,ispec)
                amascs(icp,itint,ispec) = amascp(icp,itint,ispec) /REAL(icp-1,kind=8)
            END DO
            amascs(ncenth(itint,ispec),itint,ispec) = zero
            amascs(ncenpy(itint,ispec),itint,ispec)  &
                = amascp(ncenpy(itint,ispec),itint,ispec)
        END DO
    END DO


    giblet = LOG(prefgb/rguniv)
    DO ispec = 1,nspec
        DO itint = 1,ntint(ispec)
            amolgb(1,itint,ispec)= amolcp(ncenpy(itint,ispec),itint,ispec)  &
                - amolcp(1,itint,ispec) + giblet
            DO icp = 2,ncpoly(itint,ispec)
                amolgb(icp,itint,ispec) = amolcp(icp,itint,ispec) /REAL(icp*(icp-1),kind=8)
            END DO
            amolgb(ncenth(itint,ispec),itint,ispec)  &
                = amolcp(ncenth(itint,ispec),itint,ispec)
            amolgb(ncenpy(itint,ispec),itint,ispec) = amolcp(1,itint,ispec) - one
        END DO
    END DO

    DO ispec = 1,nspec
        DO itint = 1,ntint(ispec)
            DO icp = 1,ncofcp(itint,ispec)
                amolcp(icp,itint,ispec) = amolcp(icp,itint,ispec)*rguniv
            END DO
        END DO
    END DO


    DO ispec = 1,nspec
        olewis(ispec) = one/clewis(ispec)
    END DO


    alamdc = 0.0000258_8
    rlamda = 0.70_8
    tlamda = 298.0_8
    prantl = 0.70_8

    alamda = alamdc*EXP(-rlamda*LOG(tlamda))


#ifdef OPS_WITH_CUDAFOR
    alamdc_opsconstant = alamdc
    rlamda_opsconstant = rlamda
    tlamda_opsconstant = tlamda
    prantl_opsconstant = prantl

    alamda_opsconstant = alamda
#endif

END SUBROUTINE chemin
