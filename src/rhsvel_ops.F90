!
! auto-generated by ops_fortran.py
!
SUBROUTINE rhsvel

    use OPS_Fortran_Declarations
  use OPS_Fortran_RT_Support
  use MATHS_KERNEL_EQU_MODULE
  use BOUNDARY_KERNEL_VELCOMP_XDIR_MODULE
  use BOUNDARY_KERNEL_VELCOMP_YDIR_MODULE
  use BOUNDARY_KERNEL_VELCOMP_ZDIR_MODULE
  use MATHS_KERNEL_EQW_MODULE
  use MATHS_KERNEL_EQQ_MODULE
  use BOUNDARY_KERNEL_VELDERIV_XDIR_MODULE
  use BOUNDARY_KERNEL_VELDERIV_YDIR_MODULE
  use BOUNDARY_KERNEL_VELDERIV_ZDIR_MODULE
  use MATHS_KERNEL_EQAB_MODULE
  use MATHS_KERNEL_EQAO_MODULE
  use BOUNDARY_KERNEL_PRESSURE_XDIR_MODULE
  use BOUNDARY_KERNEL_PRESSURE_YDIR_MODULE
  use BOUNDARY_KERNEL_PRESSURE_ZDIR_MODULE
  use MATHS_KERNEL_EQS_MODULE
  use MATHS_KERNEL_EQAL_MODULE
  use MATHS_KERNEL_EQAK_MODULE
  use MATHS_KERNEL_EQG_MODULE
  use COPY_KERNEL_MODULE
  use MATHS_KERNEL_EQR_MODULE
  use MATHS_KERNEL_EQN_MODULE
  use MATHS_KERNEL_EQAD_MODULE
  use MATHS_KERNEL_EQV_MODULE
  use MATHS_KERNEL_EQAA_MODULE
  use MATHS_KERNEL_EQAR_MODULE
  use MATHS_KERNEL_EQI_MODULE
  use MATHS_KERNEL_EQAJ_MODULE
  use MATHS_KERNEL_EQAE_MODULE
  use MATHS_KERNEL_EQAC_MODULE
  use MATHS_KERNEL_EQTAU_MODULE
  use MATHS_KERNEL_EQC_MODULE

    use OPS_CONSTANTS
    use, intrinsic :: ISO_C_BINDING

    use data_types
    use com_senga
    use com_ops_senga

















    integer(kind=4) :: rangexyz(6)






    rangexyz = [1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz]
    call maths_kernel_eqU_host("A = B/C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqU_host("A = B/C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqU_host("A = B/C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_READ))












    IF(fxlcnv)THEN
        rangexyz = [1,1,1,nyglbl,1,nzglbl]
        call boundary_kernel_velcomp_xdir_host("COLLECT VELOCITY COMPONENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_struxl, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strvxl, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strwxl, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fxrcnv)THEN
        rangexyz = [nxglbl,nxglbl,1,nyglbl,1,nzglbl]
        call boundary_kernel_velcomp_xdir_host("COLLECT VELOCITY COMPONENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_struxr, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strvxr, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strwxr, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF

    IF(fylcnv)THEN
        rangexyz = [1,nxglbl,1,1,1,nzglbl]
        call boundary_kernel_velcomp_ydir_host("COLLECT VELOCITY COMPONENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_struyl, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strvyl, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strwyl, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fyrcnv)THEN
        rangexyz = [1,nxglbl,nyglbl,nyglbl,1,nzglbl]
        call boundary_kernel_velcomp_ydir_host("COLLECT VELOCITY COMPONENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_struyr, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strvyr, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strwyr, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF

    IF(fzlcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,1,1]
        call boundary_kernel_velcomp_zdir_host("COLLECT VELOCITY COMPONENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_struzl, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strvzl, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strwzl, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fzrcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,nzglbl,nzglbl]
        call boundary_kernel_velcomp_zdir_host("COLLECT VELOCITY COMPONENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_struzr, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strvzr, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_strwzr, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF





    rangexyz = [1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz]
    call maths_kernel_eqW_host("A = B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ))


    call dfbydx(d_store7,d_store4)






    rangexyz = [1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz]
    call maths_kernel_eqW_host("A = B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ))


    call dfbydy(d_store7,d_store1)
    call dfbydx(d_store7,d_store5)




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz]
    call maths_kernel_eqW_host("A = B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ))


    call dfbydz(d_store7,d_store1)
    call dfbydx(d_store7,d_store6)



    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz]
    call maths_kernel_eqW_host("A = B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ))

    call dfbydy(d_store7,d_store1)


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz]
    call maths_kernel_eqW_host("A = B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ))


    call dfbydz(d_store7,d_store1)
    call dfbydy(d_store7,d_store2)



    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz]
    call maths_kernel_eqW_host("A = B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ))

    call dfbydz(d_store7,d_store1)


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    call dfbydx(d_utmp,d_store1)
    call dfbydy(d_vtmp,d_store2)
    call dfbydz(d_wtmp,d_store3)





    IF(fxlcnv)THEN
        rangexyz = [1,1,1,nyglbl,1,nzglbl]
        call boundary_kernel_velderiv_xdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl1xl, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fxrcnv)THEN
        rangexyz = [nxglbl,nxglbl,1,nyglbl,1,nzglbl]
        call boundary_kernel_velderiv_xdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl1xr, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF

    IF(fylcnv)THEN
        rangexyz = [1,nxglbl,1,1,1,nzglbl]
        call boundary_kernel_velderiv_ydir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl1yl, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fyrcnv)THEN
        rangexyz = [1,nxglbl,nyglbl,nyglbl,1,nzglbl]
        call boundary_kernel_velderiv_ydir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl1yr, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF

    IF(fzlcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,1,1]
        call boundary_kernel_velderiv_zdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl1zl, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fzrcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,nzglbl,nzglbl]
        call boundary_kernel_velderiv_zdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl1zr, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF



    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAB_host("A = B+C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_divm, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqW_host("A = B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAO_host("A = -half*(B+C)", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ))


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAB_host("A = B+C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_divm, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqW_host("A = B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAO_host("A = -half*(B+C)", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ))


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAB_host("A = B+C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_divm, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqW_host("A = B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAO_host("A = -half*(B+C)", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ))





    call dfbydx(d_prun,d_store4)
    call dfbydy(d_prun,d_store5)
    call dfbydz(d_prun,d_store6)





    IF(fxlcnv)THEN
        rangexyz = [1,1,1,nyglbl,1,nzglbl]
        call boundary_kernel_pressure_xdir_host("COLLECT PRESSURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_prun, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_strpxl, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcl5xl, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fxrcnv)THEN
        rangexyz = [nxglbl,nxglbl,1,nyglbl,1,nzglbl]
        call boundary_kernel_pressure_xdir_host("COLLECT PRESSURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_prun, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_strpxr, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcl5xr, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF

    IF(fylcnv)THEN
        rangexyz = [1,nxglbl,1,1,1,nzglbl]
        call boundary_kernel_pressure_ydir_host("COLLECT PRESSURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_prun, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_strpyl, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcl5yl, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fyrcnv)THEN
        rangexyz = [1,nxglbl,nyglbl,nyglbl,1,nzglbl]
        call boundary_kernel_pressure_ydir_host("COLLECT PRESSURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_prun, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_strpyr, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcl5yr, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF

    IF(fzlcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,1,1]
        call boundary_kernel_pressure_zdir_host("COLLECT PRESSURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_prun, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_strpzl, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcl5zl, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fzrcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,nzglbl,nzglbl]
        call boundary_kernel_pressure_zdir_host("COLLECT PRESSURE AND ITS GRADIENTS FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_prun, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_strpzr, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_bcl5zr, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqS_host("A = A-B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqS_host("A = A-B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqS_host("A = A-B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAL_host("A = A-B*C-D*E-F*G", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAK_host("A = A-B*(C+D+E)", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_prun, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz]
    call maths_kernel_eqG_host("A = A*var", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_gbl(prantl, 1, "real(kind=8)", OPS_READ))




    IF(flmavt)THEN
        rangexyz = [1-nhalox,nxglbl+nhalox,1-nhaloy,nyglbl+nhaloy,1-nhaloz,nzglbl+nhaloz]
        call copy_kernel_host("copy", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                          & ops_arg_dat(d_difmix, 1, s3d_000, "real(kind=8)", OPS_READ))












    END IF




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqR_host("A = B+C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqN_host("A = var1*B-var2*A", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(fthd, 1, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(tthd, 1, "real(kind=8)", OPS_READ))


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAD_host("A = A+B*C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    call dfbydx(d_transp,d_store4)






    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqV_host("A = A*B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_READ))


    IF(fxlvsn) call zeroxl(d_store6)
    IF(fxrvsn) call zeroxr(d_store6)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAA_host("A = A+B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ))





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqR_host("A = B+C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqN_host("A = var1*B-var2*A", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(fthd, 1, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(tthd, 1, "real(kind=8)", OPS_READ))


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAD_host("A = A+B*C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))




    call dfbydy(d_transp,d_store5)






    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqV_host("A = A*B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_READ))


    IF(fylvsn) call zeroyl(d_store6)
    IF(fyrvsn) call zeroyr(d_store6)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAA_host("A = A+B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ))





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqN_host("A = var1*B-var2*A", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(fthd, 1, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(tthd, 1, "real(kind=8)", OPS_READ))


    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAD_host("A = A+B*C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))




    call dfbydz(d_transp,d_store6)






    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqV_host("A = A*B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ))


    IF(fzlvsn) call zerozl(d_store1)
    IF(fzrvsn) call zerozr(d_store1)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAA_host("A = A+B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))





    call dfbydy(d_utmp,d_store1)


    IF(fylcnv)THEN
        rangexyz = [1,nxglbl,1,1,1,nzglbl]
        call boundary_kernel_velderiv_ydir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl3yl, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fyrcnv)THEN
        rangexyz = [1,nxglbl,nyglbl,nyglbl,1,nzglbl]
        call boundary_kernel_velderiv_ydir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl3yr, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAR_host("A = A-half*B*C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    call dfbydx(d_vtmp,d_store2)



    IF(fxlcnv)THEN
        rangexyz = [1,1,1,nyglbl,1,nzglbl]
        call boundary_kernel_velderiv_xdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl3xl, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fxrcnv)THEN
        rangexyz = [nxglbl,nxglbl,1,nyglbl,1,nzglbl]
        call boundary_kernel_velderiv_xdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl3xr, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAR_host("A = A-half*B*C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqR_host("A = B+C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))

    call d2fdxy(d_utmp,d_store1)

    call d2fdxy(d_vtmp,d_store2)






    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqI_host("A = var*B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(tthd, 1, "real(kind=8)", OPS_READ))


    IF(fxlvsn) call zeroxl(d_store3)
    IF(fxrvsn) call zeroxr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqS_host("A = A-B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAJ_host("A = A-B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))







    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqI_host("A = var*B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(tthd, 1, "real(kind=8)", OPS_READ))


    IF(fylvsn) call zeroyl(d_store3)
    IF(fyrvsn) call zeroyr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqS_host("A = A-B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAJ_host("A = A-B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))




    call d2fdy2(d_utmp,d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAE_host("A = A*B+C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_READ))


    IF(fylvst) call zeroyl(d_store3)
    IF(fyrvst) call zeroyr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAA_host("A = A+B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))




    call d2fdx2(d_vtmp,d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAE_host("A = A*B+C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_READ))


    IF(fxlvst) call zeroxl(d_store3)
    IF(fxrvst) call zeroxr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAA_host("A = A+B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAC_host("A = A+B*C*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ))



    call dfbydz(d_utmp,d_store1)


    IF(fzlcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,1,1]
        call boundary_kernel_velderiv_zdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl3zl, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fzrcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,nzglbl,nzglbl]
        call boundary_kernel_velderiv_zdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl3zr, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAR_host("A = A-half*B*C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    call dfbydx(d_wtmp,d_store2)


    IF(fxlcnv)THEN
        rangexyz = [1,1,1,nyglbl,1,nzglbl]
        call boundary_kernel_velderiv_xdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl4xl, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fxrcnv)THEN
        rangexyz = [nxglbl,nxglbl,1,nyglbl,1,nzglbl]
        call boundary_kernel_velderiv_xdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl4xr, 1, s3d_000_strid3d_yz, "real(kind=8)", OPS_WRITE))

    END IF





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAR_host("A = A-half*B*C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqR_host("A = B+C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))

    call d2fdxz(d_utmp,d_store1)

    call d2fdxz(d_wtmp,d_store2)






    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqI_host("A = var*B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(tthd, 1, "real(kind=8)", OPS_READ))


    IF(fxlvsn) call zeroxl(d_store3)
    IF(fxrvsn) call zeroxr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqS_host("A = A-B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAJ_host("A = A-B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))






    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqI_host("A = var*B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(tthd, 1, "real(kind=8)", OPS_READ))


    IF(fzlvsn) call zerozl(d_store3)
    IF(fzrvsn) call zerozr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqS_host("A = A-B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAJ_host("A = A-B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))




    call d2fdz2(d_utmp,d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAE_host("A = A*B+C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ))


    IF(fzlvst) call zerozl(d_store3)
    IF(fzrvst) call zerozr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAA_host("A = A+B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))




    call d2fdx2(d_wtmp,d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAE_host("A = A*B+C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store4, 1, s3d_000, "real(kind=8)", OPS_READ))


    IF(fxlvst) call zeroxl(d_store3)
    IF(fxrvst) call zeroxr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAA_host("A = A+B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAC_host("A = A+B*C*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ))



    call dfbydz(d_vtmp,d_store1)



    IF(fzlcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,1,1]
        call boundary_kernel_velderiv_zdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl4zl, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fzrcnv)THEN
        rangexyz = [1,nxglbl,1,nyglbl,nzglbl,nzglbl]
        call boundary_kernel_velderiv_zdir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl4zr, 1, s3d_000_strid3d_xy, "real(kind=8)", OPS_WRITE))

    END IF





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAR_host("A = A-half*B*C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    call dfbydy(d_wtmp,d_store2)



    IF(fylcnv)THEN
        rangexyz = [1,nxglbl,1,1,1,nzglbl]
        call boundary_kernel_velderiv_ydir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl4yl, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF
    IF(fyrcnv)THEN
        rangexyz = [1,nxglbl,nyglbl,nyglbl,1,nzglbl]
        call boundary_kernel_velderiv_ydir_host("COLLECT VELOCITY DERIVATIVES FOR BCs", senga_grid, 3, rangexyz, &
                          & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                          & ops_arg_dat(d_bcl4yr, 1, s3d_000_strid3d_xz, "real(kind=8)", OPS_WRITE))

    END IF





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAR_host("A = A-half*B*C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))






    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqR_host("A = B+C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))

    call d2fdyz(d_vtmp,d_store1)

    call d2fdyz(d_wtmp,d_store2)







    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqI_host("A = var*B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(tthd, 1, "real(kind=8)", OPS_READ))


    IF(fylvsn) call zeroyl(d_store3)
    IF(fyrvsn) call zeroyr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqS_host("A = A-B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAJ_host("A = A-B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))







    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqI_host("A = var*B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(tthd, 1, "real(kind=8)", OPS_READ))


    IF(fzlvsn) call zerozl(d_store3)
    IF(fzrvsn) call zerozr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqS_host("A = A-B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAJ_host("A = A-B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))





    call d2fdz2(d_vtmp,d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAE_host("A = A*B+C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store6, 1, s3d_000, "real(kind=8)", OPS_READ))


    IF(fzlvst) call zerozl(d_store3)
    IF(fzrvst) call zerozr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAA_host("A = A+B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))




    call d2fdy2(d_wtmp,d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAE_host("A = A*B+C*D", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_RW), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store5, 1, s3d_000, "real(kind=8)", OPS_READ))


    IF(fylvst)call zeroyl(d_store3)
    IF(fyrvst)call zeroyr(d_store3)

    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqQ_host("A = A+B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))

    call maths_kernel_eqAA_host("A = A+B*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ))





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqAC_host("A = A+B*C*C", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store7, 1, s3d_000, "real(kind=8)", OPS_READ))




    call d2fdx2(d_utmp,d_store1)
    call d2fdy2(d_vtmp,d_store2)
    call d2fdz2(d_wtmp,d_store3)


    IF(fxlvsn) call zeroxl(d_store1)
    IF(fxrvsn) call zeroxr(d_store1)

    IF(fylvsn) call zeroyl(d_store2)
    IF(fyrvsn) call zeroyr(d_store2)

    IF(fzlvsn) call zerozl(d_store3)
    IF(fzrvsn) call zerozr(d_store3)



    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqtau_host("TAU", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_urhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store1, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_utmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(fthd, 1, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqtau_host("TAU", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_vrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store2, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_vtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(fthd, 1, "real(kind=8)", OPS_READ))




    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqtau_host("TAU", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_wrhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_erhs, 1, s3d_000, "real(kind=8)", OPS_INC), &
                      & ops_arg_dat(d_transp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_store3, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_dat(d_wtmp, 1, s3d_000, "real(kind=8)", OPS_READ), &
                      & ops_arg_gbl(fthd, 1, "real(kind=8)", OPS_READ))





    rangexyz = [1,nxglbl,1,nyglbl,1,nzglbl]
    call maths_kernel_eqC_host("A = -B", senga_grid, 3, rangexyz, &
                      & ops_arg_dat(d_drhs, 1, s3d_000, "real(kind=8)", OPS_WRITE), &
                      & ops_arg_dat(d_divm, 1, s3d_000, "real(kind=8)", OPS_READ))



END SUBROUTINE rhsvel
